<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Gutiérrez - Stalyn Guerrero">

<title>Modelos lineales y modelos de vinculo logístico en R y STAN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="2Modelos Lineal y vinculo logistico_files/libs/clipboard/clipboard.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/quarto.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/popper.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/anchor.min.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="2Modelos Lineal y vinculo logistico_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modelos lineales y modelos de vinculo logístico en R y STAN</h1>
<p class="subtitle lead">CEPAL - División de Estadísticas Sociales</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés Gutiérrez - Stalyn Guerrero </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="modelos-lineales." class="level2">
<h2 class="anchored" data-anchor-id="modelos-lineales.">Modelos lineales.</h2>
<p>La regresión lineal es la técnica básica del análisis econométrico. Mediante dicha técnica tratamos de determinar relaciones de dependencia de tipo lineal entre una variable dependiente o endógena, respecto de una o varias variables explicativas o exógenas.</p>
<p><span class="math display">\[
\begin{eqnarray*}
\left[\begin{array}{c}
Y_{1}\\
Y_{2}\\
\vdots\\
Y_{n}
\end{array}\right] &amp; = &amp; \left[\begin{array}{cccc}
1 &amp; x_{11} &amp; \cdots &amp; x_{1k}\\
1 &amp; x_{21} &amp; \cdots &amp; x_{2k}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; x_{n1} &amp; \cdots &amp; x_{nk}
\end{array}\right]\left[\begin{array}{c}
\beta_{0}\\
\beta_{1}\\
\vdots\\
\beta_{k}
\end{array}\right]+\left[\begin{array}{c}
\epsilon_{1}\\
\epsilon_{2}\\
\vdots\\
\epsilon_{n}
\end{array}\right]
\end{eqnarray*}
\]</span> escrita de forma general sería</p>
<p><span class="math display">\[
\begin{align*}
\boldsymbol{Y} &amp; = &amp; \boldsymbol{X\beta} + \boldsymbol{\epsilon} \\
E\left(\boldsymbol{Y}\mid \boldsymbol{X}\right) &amp; = &amp; \boldsymbol{XB}
\end{align*}
\]</span></p>
<p>donde <span class="math inline">\(\boldsymbol{\epsilon} \sim N\left( 0, \sigma^2\boldsymbol{I}_n\right)\)</span> y el estimador de <span class="math inline">\(B\)</span> esta dado por:</p>
<p><span class="math display">\[
\boldsymbol{\hat{B}}=\boldsymbol{\left(X^{T}X\right)^{-1}X^{T}Y}
\]</span></p>
</section>
<section id="modelos-lineales-bayesiano." class="level2">
<h2 class="anchored" data-anchor-id="modelos-lineales-bayesiano.">Modelos lineales bayesiano.</h2>
<p>En primer lugar, nótese que el interés particular recae en la distribución del vector de <span class="math inline">\(n\)</span> variables aleatorias <span class="math inline">\(\mathbf{Y}=(Y_1\ldots,Y_n)'\)</span> condicional a la matriz de variables auxiliares <span class="math inline">\(\mathbf{X}\)</span> e indexada por el vector de parámetros de interés <span class="math inline">\(\boldsymbol{\beta}=(\beta_0,\ldots,\beta_k)'\)</span> dada por <span class="math inline">\(p(\mathbf{Y} \mid \boldsymbol{\beta},\mathbf{X})\)</span>.</p>
<p>El modelo básico y clásico asume que la verosimilitud para las variables de interés es</p>
<p><span class="math display">\[
\begin{equation*}
\mathbf{Y} \mid \boldsymbol{\beta},\sigma^2,\mathbf{X}\sim N_n(\mathbf{X}\boldsymbol{\beta},\sigma^2\mathbf{I}_n)
\end{equation*}
\]</span></p>
<p>en donde <span class="math inline">\(\mathbf{I}_n\)</span> denota la matriz identidad de orden <span class="math inline">\(n\times n\)</span>. Por supuesto, el modelo normal no es el único que se puede postular como verosimilitud para los datos.</p>
<section id="parámetros-dependientes." class="level3">
<h3 class="anchored" data-anchor-id="parámetros-dependientes.">Parámetros dependientes.</h3>
<p>Los parámetros de interés son <span class="math inline">\(\boldsymbol{\beta}\)</span> y <span class="math inline">\(\sigma^2\)</span> y su distribuciones previa conjunta se supone que está dada por</p>
<p><span class="math display">\[
\begin{equation*}
p(\boldsymbol{\beta},\sigma^2)=p(\boldsymbol{\beta} \mid \sigma^2)p(\sigma^2)
\end{equation*}
\]</span></p>
<p>Específicamente, la distribución previa del parámetro <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionada a <span class="math inline">\(\sigma^2\)</span> es informativa y está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2 \sim N_q(\mathbf{b},\sigma^2\mathbf{B})
\end{equation*}
\]</span></p>
<p>en donde <span class="math inline">\(\mathbf{b}\)</span> es un vector de medias y <span class="math inline">\(\mathbf{B}\)</span> es una matriz de varianzas simétrica y definida positiva. Por otro lado, la distribución previa del parámetro <span class="math inline">\(\sigma^2\)</span> también se considera informativa y dada por</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \sim Inversa-Gamma\left( \frac{n_0}{2}, \frac{n_0\sigma^2_0}{2} \right)
\end{equation*}
\]</span></p>
<p>La distribución posterior conjunta de los parámetros de interés <span class="math inline">\(\boldsymbol{\beta},\sigma^2\)</span> está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\boldsymbol{\beta},\sigma^2 \mid \mathbf{Y},\mathbf{X})
&amp;=(\sigma^2)^{-q/2}
\exp\left\{-\frac{1}{2\sigma^2}(\boldsymbol{\beta}-\mathbf{b}_q)'\mathbf{B}_q^{-1}(\boldsymbol{\beta}-\mathbf{b}_q)\right\}
\notag
\\ &amp;\hspace{3cm} \times
(\sigma^2)^{-n_1/2-1}
\exp\left\{-\frac{n_1\sigma^2_1}{2\sigma^2}\right\}
\end{align}
\]</span> donde</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}_q &amp;= \left(\mathbf{B}^{-1}+\mathbf{X}'\mathbf{X}\right)^{-1}\\
\mathbf{b}_q &amp;=\mathbf{B}_q\left(\mathbf{B}^{-1}\mathbf{b}+\mathbf{X}'\mathbf{Y}\right)
\end{align*}
\]</span></p>
<p>y además</p>
<p><span class="math display">\[
\begin{align*}
n_1&amp;=n_0+n\\
n_1\sigma^2_1&amp;=
n_0\sigma^2_0+(\mathbf{Y}-\mathbf{X}\mathbf{b}_q)'\mathbf{Y}+(\mathbf{b}-\mathbf{b}_q)'\mathbf{B}^{-1}\mathbf{b}
\end{align*}
\]</span></p>
<p>donde <span class="math inline">\(n_0\)</span> denota el número de datos previos. La distribución posterior conjunta de los parámetros de interés tiene la forma de la distribución Normal-Gamma.</p>
<p>La distribución posterior del vector de parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionada a <span class="math inline">\(\sigma^2,\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2,\mathbf{Y},\mathbf{X} \sim N_q(\mathbf{b}_q,\sigma^2\mathbf{B}_q)
\end{equation*}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\sigma^2\)</span> condicionada es</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \mid \mathbf{Y},\mathbf{X} \sim Inversa-Gamma\left(\frac{n_1}{2},\frac{\sigma^2_1}{2}\right)
\end{equation*}
\]</span></p>
</section>
<section id="parámetros-independientes" class="level3">
<h3 class="anchored" data-anchor-id="parámetros-independientes">Parámetros independientes</h3>
<p>En esta ocasión se considera que los parámetros son independientes previa; es decir que la distribución previa conjunta está dada por</p>
<p><span class="math display">\[
\begin{equation*}
p(\boldsymbol{\beta},\sigma^2)=p(\boldsymbol{\beta})p(\sigma^2)
\end{equation*}
\]</span></p>
<p>Como es natural, la distribución previa del vector de parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> es normal, aunque esta vez la matriz de varianzas no va a depender del otro parámetro <span class="math inline">\(\sigma^2\)</span>, por lo tanto se tiene que</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span></p>
<p>Igualmente, el parámetro <span class="math inline">\(\sigma^2\)</span> no depende de <span class="math inline">\(\boldsymbol{\beta}\)</span> y es posible asignarle la siguiente distribución previa</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2\sim Inversa-Gamma\left(\frac{n_0}{2},\frac{n_0\sigma^2_0}{2}\right)
\end{equation*}
\]</span></p>
<p>la distribución posterior conjunta de <span class="math inline">\(\boldsymbol{\beta}\)</span> y <span class="math inline">\(\sigma^2\)</span> puede ser escrita como</p>
<p><span class="math display">\[
\begin{align}
p(\boldsymbol{\beta},\sigma^2 \mid \mathbf{Y},\mathbf{X})&amp;\propto p(\mathbf{Y} \mid \boldsymbol{\beta},\sigma^2)p(\boldsymbol{\beta})p(\sigma^2)\notag \\
&amp;\propto (\sigma^2)^{-n/2} \exp\left\{-\frac{1}{2\sigma^2}\left(Q(\boldsymbol{\beta})+S^2_e\right)\right\}\notag\\
&amp;\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
(\sigma^2)^{-n_0/2-1} \exp\left\{-\frac{n_0\sigma^2_0}{2\sigma^2}\right\}\notag\\
&amp;=(\sigma^2)^{-\frac{n+n_0}{2}-1}
\exp\left\{-\frac{1}{2\sigma^2}\left[Q(\boldsymbol{\beta})+S^2_e+n_0\sigma^2_0\right]\right\} \notag \\
&amp;\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionado a <span class="math inline">\(\sigma^2,\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2,\mathbf{Y},\mathbf{X} \sim N_q(\mathbf{b}_q,\mathbf{B}_q)
\end{equation*}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}_q &amp;= \left(\mathbf{B}^{-1}+\frac{1}{\sigma^2}\mathbf{X}'\mathbf{X}\right)^{-1}\\
\mathbf{b}_q &amp;=\mathbf{B}_q\left(\mathbf{B}^{-1}\mathbf{b}+\frac{1}{\sigma^2}\mathbf{X}'\mathbf{Y}\right)
\end{align*}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\sigma^2\)</span> condicionado a <span class="math inline">\(\boldsymbol{\beta},\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \mid \boldsymbol{\beta},\mathbf{Y},\mathbf{X} \sim Inversa-Gamma\left( \frac{n_1}{2}, \frac{n_1\sigma_{\boldsymbol{\beta}}^2}{2}  \right)
\end{equation*}
\]</span></p>
<p>donde <span class="math inline">\(n_1=n+n_0\)</span>,<br>
<span class="math display">\[
\begin{align*}
n_1\sigma_{\boldsymbol{\beta}}^2&amp;=&amp;Q(\boldsymbol{\beta})+S^2_e+n_0\sigma^2_0\\
Q(\boldsymbol{\beta})&amp;=&amp;(\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})'(\mathbf{X}'\mathbf{X})(\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})\\
S^2_e&amp;=&amp;(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})'(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})
\end{align*}
\]</span></p>
<p>y <span class="math inline">\(\sigma^2_0\)</span> es una estimación previa del parámetro de interés <span class="math inline">\(\sigma^2\)</span>.</p>
</section>
<section id="práctica-en-stan-modelo-lineal-simple" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-modelo-lineal-simple">Práctica en <strong>STAN</strong> (Modelo lineal simple)</h3>
<ul>
<li>ENCUESTA CONTINUA DE HOGARES (ECH) 2020</li>
</ul>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-1_e85a199475c4803045550aa4cfdfa93a">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/encuestaPER21N.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;</span> <span class="dv">18</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>statelevel_predictors_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/statelevel_predictors_df.rds"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>datalm <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  depto ,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  ingcorte) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(depto) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(  <span class="at">Promedio =</span> <span class="fu">mean</span>(ingcorte)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"depto"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(datalm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:right;"> Promedio </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivo </th>
   <th style="text-align:right;"> suelo_urbano </th>
   <th style="text-align:right;"> modificacion_humana </th>
   <th style="text-align:right;"> tiempo_hospital </th>
   <th style="text-align:right;"> tiempo_hospital_caminando </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> discapacidad1 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 678.8795 </td>
   <td style="text-align:right;"> 41.76282 </td>
   <td style="text-align:right;"> 43.48416 </td>
   <td style="text-align:right;"> 43.57739 </td>
   <td style="text-align:right;"> 46.97255 </td>
   <td style="text-align:right;"> 48.64957 </td>
   <td style="text-align:right;"> 48.29499 </td>
   <td style="text-align:right;"> 0.4935 </td>
   <td style="text-align:right;"> 0.4934 </td>
   <td style="text-align:right;"> 0.2356 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.1665 </td>
   <td style="text-align:right;"> 0.0709 </td>
   <td style="text-align:right;"> 0.0246 </td>
   <td style="text-align:right;"> 0.0876 </td>
   <td style="text-align:right;"> 0.3958 </td>
   <td style="text-align:right;"> 0.2696 </td>
   <td style="text-align:right;"> 0.1188 </td>
   <td style="text-align:right;"> 0.1205 </td>
   <td style="text-align:right;"> 0.6632 </td>
   <td style="text-align:right;"> 0.4585 </td>
   <td style="text-align:right;"> 0.4646 </td>
   <td style="text-align:right;"> 0.5092 </td>
   <td style="text-align:right;"> 0.9557 </td>
   <td style="text-align:right;"> 0.4561 </td>
   <td style="text-align:right;"> 0.8770 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.1621 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 798.8970 </td>
   <td style="text-align:right;"> 51.61811 </td>
   <td style="text-align:right;"> 51.73498 </td>
   <td style="text-align:right;"> 52.22498 </td>
   <td style="text-align:right;"> 52.46159 </td>
   <td style="text-align:right;"> 46.91322 </td>
   <td style="text-align:right;"> 46.96396 </td>
   <td style="text-align:right;"> 0.7076 </td>
   <td style="text-align:right;"> 0.5038 </td>
   <td style="text-align:right;"> 0.2358 </td>
   <td style="text-align:right;"> 0.2060 </td>
   <td style="text-align:right;"> 0.1898 </td>
   <td style="text-align:right;"> 0.0984 </td>
   <td style="text-align:right;"> 0.0245 </td>
   <td style="text-align:right;"> 0.1134 </td>
   <td style="text-align:right;"> 0.2831 </td>
   <td style="text-align:right;"> 0.3200 </td>
   <td style="text-align:right;"> 0.2018 </td>
   <td style="text-align:right;"> 0.2715 </td>
   <td style="text-align:right;"> 0.5615 </td>
   <td style="text-align:right;"> 0.3902 </td>
   <td style="text-align:right;"> 0.4254 </td>
   <td style="text-align:right;"> 0.4013 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.3548 </td>
   <td style="text-align:right;"> 0.7195 </td>
   <td style="text-align:right;"> 0.3978 </td>
   <td style="text-align:right;"> 0.2530 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.0021 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 671.7007 </td>
   <td style="text-align:right;"> 44.50173 </td>
   <td style="text-align:right;"> 50.32670 </td>
   <td style="text-align:right;"> 47.42621 </td>
   <td style="text-align:right;"> 46.64527 </td>
   <td style="text-align:right;"> 46.80769 </td>
   <td style="text-align:right;"> 46.90296 </td>
   <td style="text-align:right;"> 0.5736 </td>
   <td style="text-align:right;"> 0.5019 </td>
   <td style="text-align:right;"> 0.2427 </td>
   <td style="text-align:right;"> 0.1974 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.0936 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 0.1078 </td>
   <td style="text-align:right;"> 0.2814 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.1768 </td>
   <td style="text-align:right;"> 0.6764 </td>
   <td style="text-align:right;"> 0.6685 </td>
   <td style="text-align:right;"> 0.4673 </td>
   <td style="text-align:right;"> 0.4394 </td>
   <td style="text-align:right;"> 0.5544 </td>
   <td style="text-align:right;"> 0.9112 </td>
   <td style="text-align:right;"> 0.4614 </td>
   <td style="text-align:right;"> 0.8614 </td>
   <td style="text-align:right;"> 0.3859 </td>
   <td style="text-align:right;"> 0.2267 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 1084.0175 </td>
   <td style="text-align:right;"> 59.90582 </td>
   <td style="text-align:right;"> 49.27408 </td>
   <td style="text-align:right;"> 57.20224 </td>
   <td style="text-align:right;"> 53.91574 </td>
   <td style="text-align:right;"> 47.41502 </td>
   <td style="text-align:right;"> 48.26891 </td>
   <td style="text-align:right;"> 0.9475 </td>
   <td style="text-align:right;"> 0.5062 </td>
   <td style="text-align:right;"> 0.2555 </td>
   <td style="text-align:right;"> 0.2263 </td>
   <td style="text-align:right;"> 0.1951 </td>
   <td style="text-align:right;"> 0.0862 </td>
   <td style="text-align:right;"> 0.0176 </td>
   <td style="text-align:right;"> 0.1089 </td>
   <td style="text-align:right;"> 0.1919 </td>
   <td style="text-align:right;"> 0.3300 </td>
   <td style="text-align:right;"> 0.3409 </td>
   <td style="text-align:right;"> 0.2828 </td>
   <td style="text-align:right;"> 0.5233 </td>
   <td style="text-align:right;"> 0.3959 </td>
   <td style="text-align:right;"> 0.4762 </td>
   <td style="text-align:right;"> 0.1053 </td>
   <td style="text-align:right;"> 0.6730 </td>
   <td style="text-align:right;"> 0.1097 </td>
   <td style="text-align:right;"> 0.4504 </td>
   <td style="text-align:right;"> 0.3622 </td>
   <td style="text-align:right;"> 0.4055 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.0031 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 650.0383 </td>
   <td style="text-align:right;"> 45.89331 </td>
   <td style="text-align:right;"> 56.07571 </td>
   <td style="text-align:right;"> 51.20286 </td>
   <td style="text-align:right;"> 54.72841 </td>
   <td style="text-align:right;"> 46.98491 </td>
   <td style="text-align:right;"> 47.21079 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.5022 </td>
   <td style="text-align:right;"> 0.2572 </td>
   <td style="text-align:right;"> 0.2016 </td>
   <td style="text-align:right;"> 0.1690 </td>
   <td style="text-align:right;"> 0.0867 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.1031 </td>
   <td style="text-align:right;"> 0.2907 </td>
   <td style="text-align:right;"> 0.3176 </td>
   <td style="text-align:right;"> 0.1788 </td>
   <td style="text-align:right;"> 0.6347 </td>
   <td style="text-align:right;"> 0.6610 </td>
   <td style="text-align:right;"> 0.4961 </td>
   <td style="text-align:right;"> 0.4794 </td>
   <td style="text-align:right;"> 0.4565 </td>
   <td style="text-align:right;"> 0.8963 </td>
   <td style="text-align:right;"> 0.3885 </td>
   <td style="text-align:right;"> 0.8350 </td>
   <td style="text-align:right;"> 0.4089 </td>
   <td style="text-align:right;"> 0.2332 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 624.0677 </td>
   <td style="text-align:right;"> 49.07049 </td>
   <td style="text-align:right;"> 59.98774 </td>
   <td style="text-align:right;"> 49.65565 </td>
   <td style="text-align:right;"> 60.15467 </td>
   <td style="text-align:right;"> 47.03441 </td>
   <td style="text-align:right;"> 46.95647 </td>
   <td style="text-align:right;"> 0.3973 </td>
   <td style="text-align:right;"> 0.5059 </td>
   <td style="text-align:right;"> 0.2341 </td>
   <td style="text-align:right;"> 0.2086 </td>
   <td style="text-align:right;"> 0.1755 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.0447 </td>
   <td style="text-align:right;"> 0.0838 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2494 </td>
   <td style="text-align:right;"> 0.1299 </td>
   <td style="text-align:right;"> 0.0501 </td>
   <td style="text-align:right;"> 0.7166 </td>
   <td style="text-align:right;"> 0.3984 </td>
   <td style="text-align:right;"> 0.4466 </td>
   <td style="text-align:right;"> 0.5917 </td>
   <td style="text-align:right;"> 0.9074 </td>
   <td style="text-align:right;"> 0.4849 </td>
   <td style="text-align:right;"> 0.8342 </td>
   <td style="text-align:right;"> 0.2641 </td>
   <td style="text-align:right;"> 0.1689 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.0019 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 1047.4508 </td>
   <td style="text-align:right;"> 43.14251 </td>
   <td style="text-align:right;"> 39.11361 </td>
   <td style="text-align:right;"> 44.11616 </td>
   <td style="text-align:right;"> 33.01350 </td>
   <td style="text-align:right;"> 46.65175 </td>
   <td style="text-align:right;"> 46.49964 </td>
   <td style="text-align:right;"> 1.0000 </td>
   <td style="text-align:right;"> 0.5082 </td>
   <td style="text-align:right;"> 0.2514 </td>
   <td style="text-align:right;"> 0.2260 </td>
   <td style="text-align:right;"> 0.1947 </td>
   <td style="text-align:right;"> 0.0831 </td>
   <td style="text-align:right;"> 0.0385 </td>
   <td style="text-align:right;"> 0.1096 </td>
   <td style="text-align:right;"> 0.1802 </td>
   <td style="text-align:right;"> 0.3999 </td>
   <td style="text-align:right;"> 0.2936 </td>
   <td style="text-align:right;"> 0.0891 </td>
   <td style="text-align:right;"> 0.2251 </td>
   <td style="text-align:right;"> 0.1480 </td>
   <td style="text-align:right;"> 0.2344 </td>
   <td style="text-align:right;"> 0.1327 </td>
   <td style="text-align:right;"> 0.5588 </td>
   <td style="text-align:right;"> 0.0494 </td>
   <td style="text-align:right;"> 0.3474 </td>
   <td style="text-align:right;"> 0.1623 </td>
   <td style="text-align:right;"> 0.3348 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.0022 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 725.6211 </td>
   <td style="text-align:right;"> 52.56436 </td>
   <td style="text-align:right;"> 62.71131 </td>
   <td style="text-align:right;"> 60.31193 </td>
   <td style="text-align:right;"> 66.57010 </td>
   <td style="text-align:right;"> 48.93218 </td>
   <td style="text-align:right;"> 48.67928 </td>
   <td style="text-align:right;"> 0.6583 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.2583 </td>
   <td style="text-align:right;"> 0.2098 </td>
   <td style="text-align:right;"> 0.1828 </td>
   <td style="text-align:right;"> 0.0769 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 0.1099 </td>
   <td style="text-align:right;"> 0.2629 </td>
   <td style="text-align:right;"> 0.3185 </td>
   <td style="text-align:right;"> 0.2247 </td>
   <td style="text-align:right;"> 0.6015 </td>
   <td style="text-align:right;"> 0.5666 </td>
   <td style="text-align:right;"> 0.4046 </td>
   <td style="text-align:right;"> 0.4238 </td>
   <td style="text-align:right;"> 0.3837 </td>
   <td style="text-align:right;"> 0.8317 </td>
   <td style="text-align:right;"> 0.3994 </td>
   <td style="text-align:right;"> 0.8193 </td>
   <td style="text-align:right;"> 0.3390 </td>
   <td style="text-align:right;"> 0.2841 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.0030 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 495.1369 </td>
   <td style="text-align:right;"> 43.03490 </td>
   <td style="text-align:right;"> 50.59430 </td>
   <td style="text-align:right;"> 46.46389 </td>
   <td style="text-align:right;"> 45.49424 </td>
   <td style="text-align:right;"> 46.81505 </td>
   <td style="text-align:right;"> 46.97287 </td>
   <td style="text-align:right;"> 0.4524 </td>
   <td style="text-align:right;"> 0.5106 </td>
   <td style="text-align:right;"> 0.2438 </td>
   <td style="text-align:right;"> 0.1815 </td>
   <td style="text-align:right;"> 0.1762 </td>
   <td style="text-align:right;"> 0.0950 </td>
   <td style="text-align:right;"> 0.0006 </td>
   <td style="text-align:right;"> 0.0957 </td>
   <td style="text-align:right;"> 0.3205 </td>
   <td style="text-align:right;"> 0.3030 </td>
   <td style="text-align:right;"> 0.1303 </td>
   <td style="text-align:right;"> 0.6221 </td>
   <td style="text-align:right;"> 0.7762 </td>
   <td style="text-align:right;"> 0.5457 </td>
   <td style="text-align:right;"> 0.5703 </td>
   <td style="text-align:right;"> 0.6550 </td>
   <td style="text-align:right;"> 0.9509 </td>
   <td style="text-align:right;"> 0.4499 </td>
   <td style="text-align:right;"> 0.9256 </td>
   <td style="text-align:right;"> 0.4459 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.0006 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 705.8191 </td>
   <td style="text-align:right;"> 43.40122 </td>
   <td style="text-align:right;"> 49.46332 </td>
   <td style="text-align:right;"> 44.96708 </td>
   <td style="text-align:right;"> 51.97994 </td>
   <td style="text-align:right;"> 47.62130 </td>
   <td style="text-align:right;"> 47.50204 </td>
   <td style="text-align:right;"> 0.5890 </td>
   <td style="text-align:right;"> 0.5016 </td>
   <td style="text-align:right;"> 0.2549 </td>
   <td style="text-align:right;"> 0.1987 </td>
   <td style="text-align:right;"> 0.1696 </td>
   <td style="text-align:right;"> 0.0746 </td>
   <td style="text-align:right;"> 0.0174 </td>
   <td style="text-align:right;"> 0.0933 </td>
   <td style="text-align:right;"> 0.3327 </td>
   <td style="text-align:right;"> 0.2876 </td>
   <td style="text-align:right;"> 0.1622 </td>
   <td style="text-align:right;"> 0.3336 </td>
   <td style="text-align:right;"> 0.6983 </td>
   <td style="text-align:right;"> 0.4822 </td>
   <td style="text-align:right;"> 0.5781 </td>
   <td style="text-align:right;"> 0.5009 </td>
   <td style="text-align:right;"> 0.8919 </td>
   <td style="text-align:right;"> 0.3942 </td>
   <td style="text-align:right;"> 0.7909 </td>
   <td style="text-align:right;"> 0.3321 </td>
   <td style="text-align:right;"> 0.2194 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 1120.0477 </td>
   <td style="text-align:right;"> 54.93899 </td>
   <td style="text-align:right;"> 44.90647 </td>
   <td style="text-align:right;"> 47.64537 </td>
   <td style="text-align:right;"> 41.31718 </td>
   <td style="text-align:right;"> 46.83591 </td>
   <td style="text-align:right;"> 46.83862 </td>
   <td style="text-align:right;"> 0.9305 </td>
   <td style="text-align:right;"> 0.5040 </td>
   <td style="text-align:right;"> 0.2517 </td>
   <td style="text-align:right;"> 0.2148 </td>
   <td style="text-align:right;"> 0.1807 </td>
   <td style="text-align:right;"> 0.0804 </td>
   <td style="text-align:right;"> 0.0392 </td>
   <td style="text-align:right;"> 0.1049 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.3635 </td>
   <td style="text-align:right;"> 0.2882 </td>
   <td style="text-align:right;"> 0.1156 </td>
   <td style="text-align:right;"> 0.4299 </td>
   <td style="text-align:right;"> 0.3302 </td>
   <td style="text-align:right;"> 0.3792 </td>
   <td style="text-align:right;"> 0.2521 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.1514 </td>
   <td style="text-align:right;"> 0.4882 </td>
   <td style="text-align:right;"> 0.5310 </td>
   <td style="text-align:right;"> 0.3519 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.0015 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:right;"> 750.1496 </td>
   <td style="text-align:right;"> 52.96135 </td>
   <td style="text-align:right;"> 52.47819 </td>
   <td style="text-align:right;"> 52.79902 </td>
   <td style="text-align:right;"> 55.94507 </td>
   <td style="text-align:right;"> 47.86821 </td>
   <td style="text-align:right;"> 47.83905 </td>
   <td style="text-align:right;"> 0.7541 </td>
   <td style="text-align:right;"> 0.5077 </td>
   <td style="text-align:right;"> 0.2588 </td>
   <td style="text-align:right;"> 0.2060 </td>
   <td style="text-align:right;"> 0.1755 </td>
   <td style="text-align:right;"> 0.0782 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.1024 </td>
   <td style="text-align:right;"> 0.2652 </td>
   <td style="text-align:right;"> 0.3378 </td>
   <td style="text-align:right;"> 0.2249 </td>
   <td style="text-align:right;"> 0.3079 </td>
   <td style="text-align:right;"> 0.5502 </td>
   <td style="text-align:right;"> 0.3712 </td>
   <td style="text-align:right;"> 0.4181 </td>
   <td style="text-align:right;"> 0.3128 </td>
   <td style="text-align:right;"> 0.8369 </td>
   <td style="text-align:right;"> 0.2871 </td>
   <td style="text-align:right;"> 0.6344 </td>
   <td style="text-align:right;"> 0.3066 </td>
   <td style="text-align:right;"> 0.2859 </td>
   <td style="text-align:right;"> 0.0672 </td>
   <td style="text-align:right;"> 0.0020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:right;"> 979.6290 </td>
   <td style="text-align:right;"> 56.81108 </td>
   <td style="text-align:right;"> 57.11196 </td>
   <td style="text-align:right;"> 52.91757 </td>
   <td style="text-align:right;"> 50.00971 </td>
   <td style="text-align:right;"> 46.87770 </td>
   <td style="text-align:right;"> 46.81435 </td>
   <td style="text-align:right;"> 0.8028 </td>
   <td style="text-align:right;"> 0.5088 </td>
   <td style="text-align:right;"> 0.2523 </td>
   <td style="text-align:right;"> 0.2046 </td>
   <td style="text-align:right;"> 0.1801 </td>
   <td style="text-align:right;"> 0.0832 </td>
   <td style="text-align:right;"> 0.0574 </td>
   <td style="text-align:right;"> 0.0887 </td>
   <td style="text-align:right;"> 0.2974 </td>
   <td style="text-align:right;"> 0.3031 </td>
   <td style="text-align:right;"> 0.2204 </td>
   <td style="text-align:right;"> 0.0248 </td>
   <td style="text-align:right;"> 0.4550 </td>
   <td style="text-align:right;"> 0.2852 </td>
   <td style="text-align:right;"> 0.3418 </td>
   <td style="text-align:right;"> 0.2660 </td>
   <td style="text-align:right;"> 0.7279 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.6297 </td>
   <td style="text-align:right;"> 0.2918 </td>
   <td style="text-align:right;"> 0.2819 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.0025 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 898.4505 </td>
   <td style="text-align:right;"> 50.34167 </td>
   <td style="text-align:right;"> 59.80458 </td>
   <td style="text-align:right;"> 46.11687 </td>
   <td style="text-align:right;"> 40.98730 </td>
   <td style="text-align:right;"> 46.76030 </td>
   <td style="text-align:right;"> 46.69590 </td>
   <td style="text-align:right;"> 0.8086 </td>
   <td style="text-align:right;"> 0.5124 </td>
   <td style="text-align:right;"> 0.2488 </td>
   <td style="text-align:right;"> 0.2012 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.0861 </td>
   <td style="text-align:right;"> 0.0658 </td>
   <td style="text-align:right;"> 0.0994 </td>
   <td style="text-align:right;"> 0.2665 </td>
   <td style="text-align:right;"> 0.3369 </td>
   <td style="text-align:right;"> 0.2291 </td>
   <td style="text-align:right;"> 0.0378 </td>
   <td style="text-align:right;"> 0.4177 </td>
   <td style="text-align:right;"> 0.2505 </td>
   <td style="text-align:right;"> 0.3281 </td>
   <td style="text-align:right;"> 0.1829 </td>
   <td style="text-align:right;"> 0.7133 </td>
   <td style="text-align:right;"> 0.2459 </td>
   <td style="text-align:right;"> 0.5532 </td>
   <td style="text-align:right;"> 0.2519 </td>
   <td style="text-align:right;"> 0.2836 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.0020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 1183.7580 </td>
   <td style="text-align:right;"> 89.30660 </td>
   <td style="text-align:right;"> 49.30061 </td>
   <td style="text-align:right;"> 91.84659 </td>
   <td style="text-align:right;"> 52.19096 </td>
   <td style="text-align:right;"> 46.91756 </td>
   <td style="text-align:right;"> 46.96556 </td>
   <td style="text-align:right;"> 0.9879 </td>
   <td style="text-align:right;"> 0.5088 </td>
   <td style="text-align:right;"> 0.2591 </td>
   <td style="text-align:right;"> 0.2319 </td>
   <td style="text-align:right;"> 0.1973 </td>
   <td style="text-align:right;"> 0.0867 </td>
   <td style="text-align:right;"> 0.0233 </td>
   <td style="text-align:right;"> 0.1095 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.3731 </td>
   <td style="text-align:right;"> 0.3334 </td>
   <td style="text-align:right;"> 0.1420 </td>
   <td style="text-align:right;"> 0.2911 </td>
   <td style="text-align:right;"> 0.2261 </td>
   <td style="text-align:right;"> 0.2895 </td>
   <td style="text-align:right;"> 0.2151 </td>
   <td style="text-align:right;"> 0.5290 </td>
   <td style="text-align:right;"> 0.0653 </td>
   <td style="text-align:right;"> 0.3305 </td>
   <td style="text-align:right;"> 0.2364 </td>
   <td style="text-align:right;"> 0.3871 </td>
   <td style="text-align:right;"> 0.0190 </td>
   <td style="text-align:right;"> 0.0181 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:right;"> 805.3670 </td>
   <td style="text-align:right;"> 46.00443 </td>
   <td style="text-align:right;"> 39.68968 </td>
   <td style="text-align:right;"> 44.96969 </td>
   <td style="text-align:right;"> 68.41467 </td>
   <td style="text-align:right;"> 96.38752 </td>
   <td style="text-align:right;"> 96.31929 </td>
   <td style="text-align:right;"> 0.7079 </td>
   <td style="text-align:right;"> 0.4946 </td>
   <td style="text-align:right;"> 0.2312 </td>
   <td style="text-align:right;"> 0.1890 </td>
   <td style="text-align:right;"> 0.1524 </td>
   <td style="text-align:right;"> 0.0576 </td>
   <td style="text-align:right;"> 0.0191 </td>
   <td style="text-align:right;"> 0.0787 </td>
   <td style="text-align:right;"> 0.3507 </td>
   <td style="text-align:right;"> 0.3107 </td>
   <td style="text-align:right;"> 0.1405 </td>
   <td style="text-align:right;"> 0.0817 </td>
   <td style="text-align:right;"> 0.6410 </td>
   <td style="text-align:right;"> 0.3610 </td>
   <td style="text-align:right;"> 0.5728 </td>
   <td style="text-align:right;"> 0.5076 </td>
   <td style="text-align:right;"> 0.8734 </td>
   <td style="text-align:right;"> 0.2065 </td>
   <td style="text-align:right;"> 0.6946 </td>
   <td style="text-align:right;"> 0.2949 </td>
   <td style="text-align:right;"> 0.2046 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.0016 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 17 </td>
   <td style="text-align:right;"> 1108.8324 </td>
   <td style="text-align:right;"> 42.64701 </td>
   <td style="text-align:right;"> 40.03863 </td>
   <td style="text-align:right;"> 42.34770 </td>
   <td style="text-align:right;"> 43.67581 </td>
   <td style="text-align:right;"> 53.92583 </td>
   <td style="text-align:right;"> 54.30864 </td>
   <td style="text-align:right;"> 0.8556 </td>
   <td style="text-align:right;"> 0.4723 </td>
   <td style="text-align:right;"> 0.2646 </td>
   <td style="text-align:right;"> 0.2331 </td>
   <td style="text-align:right;"> 0.1571 </td>
   <td style="text-align:right;"> 0.0345 </td>
   <td style="text-align:right;"> 0.0198 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.2470 </td>
   <td style="text-align:right;"> 0.3732 </td>
   <td style="text-align:right;"> 0.2034 </td>
   <td style="text-align:right;"> 0.2998 </td>
   <td style="text-align:right;"> 0.6473 </td>
   <td style="text-align:right;"> 0.3646 </td>
   <td style="text-align:right;"> 0.4484 </td>
   <td style="text-align:right;"> 0.2611 </td>
   <td style="text-align:right;"> 0.8375 </td>
   <td style="text-align:right;"> 0.1241 </td>
   <td style="text-align:right;"> 0.5881 </td>
   <td style="text-align:right;"> 0.2721 </td>
   <td style="text-align:right;"> 0.2513 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 0.0003 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 18 </td>
   <td style="text-align:right;"> 1303.6407 </td>
   <td style="text-align:right;"> 45.38056 </td>
   <td style="text-align:right;"> 40.28007 </td>
   <td style="text-align:right;"> 43.33857 </td>
   <td style="text-align:right;"> 38.20989 </td>
   <td style="text-align:right;"> 46.85365 </td>
   <td style="text-align:right;"> 46.93853 </td>
   <td style="text-align:right;"> 0.9214 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.2311 </td>
   <td style="text-align:right;"> 0.2362 </td>
   <td style="text-align:right;"> 0.2082 </td>
   <td style="text-align:right;"> 0.0915 </td>
   <td style="text-align:right;"> 0.0213 </td>
   <td style="text-align:right;"> 0.1157 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.3215 </td>
   <td style="text-align:right;"> 0.3420 </td>
   <td style="text-align:right;"> 0.2996 </td>
   <td style="text-align:right;"> 0.4871 </td>
   <td style="text-align:right;"> 0.4154 </td>
   <td style="text-align:right;"> 0.4735 </td>
   <td style="text-align:right;"> 0.2147 </td>
   <td style="text-align:right;"> 0.7523 </td>
   <td style="text-align:right;"> 0.1941 </td>
   <td style="text-align:right;"> 0.5862 </td>
   <td style="text-align:right;"> 0.3724 </td>
   <td style="text-align:right;"> 0.3988 </td>
   <td style="text-align:right;"> 0.0380 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:right;"> 596.0511 </td>
   <td style="text-align:right;"> 43.59944 </td>
   <td style="text-align:right;"> 46.15043 </td>
   <td style="text-align:right;"> 43.32514 </td>
   <td style="text-align:right;"> 43.92455 </td>
   <td style="text-align:right;"> 47.52889 </td>
   <td style="text-align:right;"> 47.24642 </td>
   <td style="text-align:right;"> 0.6777 </td>
   <td style="text-align:right;"> 0.4932 </td>
   <td style="text-align:right;"> 0.2606 </td>
   <td style="text-align:right;"> 0.2167 </td>
   <td style="text-align:right;"> 0.1715 </td>
   <td style="text-align:right;"> 0.0660 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.0972 </td>
   <td style="text-align:right;"> 0.2731 </td>
   <td style="text-align:right;"> 0.3399 </td>
   <td style="text-align:right;"> 0.2079 </td>
   <td style="text-align:right;"> 0.3443 </td>
   <td style="text-align:right;"> 0.6308 </td>
   <td style="text-align:right;"> 0.4806 </td>
   <td style="text-align:right;"> 0.5689 </td>
   <td style="text-align:right;"> 0.4056 </td>
   <td style="text-align:right;"> 0.9052 </td>
   <td style="text-align:right;"> 0.2189 </td>
   <td style="text-align:right;"> 0.7307 </td>
   <td style="text-align:right;"> 0.3766 </td>
   <td style="text-align:right;"> 0.2630 </td>
   <td style="text-align:right;"> 0.0740 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 876.6742 </td>
   <td style="text-align:right;"> 63.18305 </td>
   <td style="text-align:right;"> 65.08510 </td>
   <td style="text-align:right;"> 52.71714 </td>
   <td style="text-align:right;"> 54.97437 </td>
   <td style="text-align:right;"> 46.96204 </td>
   <td style="text-align:right;"> 46.97502 </td>
   <td style="text-align:right;"> 0.7956 </td>
   <td style="text-align:right;"> 0.5028 </td>
   <td style="text-align:right;"> 0.2417 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> 0.0747 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.0899 </td>
   <td style="text-align:right;"> 0.3118 </td>
   <td style="text-align:right;"> 0.3123 </td>
   <td style="text-align:right;"> 0.1881 </td>
   <td style="text-align:right;"> 0.0181 </td>
   <td style="text-align:right;"> 0.5524 </td>
   <td style="text-align:right;"> 0.2797 </td>
   <td style="text-align:right;"> 0.4113 </td>
   <td style="text-align:right;"> 0.3422 </td>
   <td style="text-align:right;"> 0.8252 </td>
   <td style="text-align:right;"> 0.4201 </td>
   <td style="text-align:right;"> 0.5998 </td>
   <td style="text-align:right;"> 0.1859 </td>
   <td style="text-align:right;"> 0.2370 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.0034 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 546.8935 </td>
   <td style="text-align:right;"> 50.23697 </td>
   <td style="text-align:right;"> 79.48816 </td>
   <td style="text-align:right;"> 54.49696 </td>
   <td style="text-align:right;"> 72.45130 </td>
   <td style="text-align:right;"> 48.56200 </td>
   <td style="text-align:right;"> 48.87507 </td>
   <td style="text-align:right;"> 0.5822 </td>
   <td style="text-align:right;"> 0.5032 </td>
   <td style="text-align:right;"> 0.2606 </td>
   <td style="text-align:right;"> 0.2104 </td>
   <td style="text-align:right;"> 0.1864 </td>
   <td style="text-align:right;"> 0.0925 </td>
   <td style="text-align:right;"> 0.0004 </td>
   <td style="text-align:right;"> 0.1305 </td>
   <td style="text-align:right;"> 0.2769 </td>
   <td style="text-align:right;"> 0.3503 </td>
   <td style="text-align:right;"> 0.1892 </td>
   <td style="text-align:right;"> 0.7313 </td>
   <td style="text-align:right;"> 0.7726 </td>
   <td style="text-align:right;"> 0.5274 </td>
   <td style="text-align:right;"> 0.6993 </td>
   <td style="text-align:right;"> 0.4359 </td>
   <td style="text-align:right;"> 0.9257 </td>
   <td style="text-align:right;"> 0.4117 </td>
   <td style="text-align:right;"> 0.7998 </td>
   <td style="text-align:right;"> 0.4683 </td>
   <td style="text-align:right;"> 0.2281 </td>
   <td style="text-align:right;"> 0.1069 </td>
   <td style="text-align:right;"> 0.0043 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 22 </td>
   <td style="text-align:right;"> 927.3917 </td>
   <td style="text-align:right;"> 45.75484 </td>
   <td style="text-align:right;"> 40.80174 </td>
   <td style="text-align:right;"> 48.96197 </td>
   <td style="text-align:right;"> 53.50148 </td>
   <td style="text-align:right;"> 49.12672 </td>
   <td style="text-align:right;"> 48.39034 </td>
   <td style="text-align:right;"> 0.7116 </td>
   <td style="text-align:right;"> 0.4870 </td>
   <td style="text-align:right;"> 0.2437 </td>
   <td style="text-align:right;"> 0.2104 </td>
   <td style="text-align:right;"> 0.1711 </td>
   <td style="text-align:right;"> 0.0599 </td>
   <td style="text-align:right;"> 0.0354 </td>
   <td style="text-align:right;"> 0.0890 </td>
   <td style="text-align:right;"> 0.3782 </td>
   <td style="text-align:right;"> 0.2871 </td>
   <td style="text-align:right;"> 0.1418 </td>
   <td style="text-align:right;"> 0.0471 </td>
   <td style="text-align:right;"> 0.6316 </td>
   <td style="text-align:right;"> 0.2968 </td>
   <td style="text-align:right;"> 0.3764 </td>
   <td style="text-align:right;"> 0.3653 </td>
   <td style="text-align:right;"> 0.8555 </td>
   <td style="text-align:right;"> 0.3479 </td>
   <td style="text-align:right;"> 0.5983 </td>
   <td style="text-align:right;"> 0.2207 </td>
   <td style="text-align:right;"> 0.1825 </td>
   <td style="text-align:right;"> 0.0759 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 23 </td>
   <td style="text-align:right;"> 877.2294 </td>
   <td style="text-align:right;"> 46.03361 </td>
   <td style="text-align:right;"> 40.43865 </td>
   <td style="text-align:right;"> 45.17116 </td>
   <td style="text-align:right;"> 38.40902 </td>
   <td style="text-align:right;"> 46.81648 </td>
   <td style="text-align:right;"> 46.75680 </td>
   <td style="text-align:right;"> 0.9430 </td>
   <td style="text-align:right;"> 0.5006 </td>
   <td style="text-align:right;"> 0.2588 </td>
   <td style="text-align:right;"> 0.2416 </td>
   <td style="text-align:right;"> 0.1970 </td>
   <td style="text-align:right;"> 0.0708 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 0.1148 </td>
   <td style="text-align:right;"> 0.2007 </td>
   <td style="text-align:right;"> 0.3698 </td>
   <td style="text-align:right;"> 0.3014 </td>
   <td style="text-align:right;"> 0.3288 </td>
   <td style="text-align:right;"> 0.5167 </td>
   <td style="text-align:right;"> 0.4417 </td>
   <td style="text-align:right;"> 0.5037 </td>
   <td style="text-align:right;"> 0.1575 </td>
   <td style="text-align:right;"> 0.7088 </td>
   <td style="text-align:right;"> 0.1765 </td>
   <td style="text-align:right;"> 0.4758 </td>
   <td style="text-align:right;"> 0.3946 </td>
   <td style="text-align:right;"> 0.3608 </td>
   <td style="text-align:right;"> 0.0318 </td>
   <td style="text-align:right;"> 0.0008 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 24 </td>
   <td style="text-align:right;"> 915.0574 </td>
   <td style="text-align:right;"> 43.83846 </td>
   <td style="text-align:right;"> 41.56019 </td>
   <td style="text-align:right;"> 41.25498 </td>
   <td style="text-align:right;"> 35.27992 </td>
   <td style="text-align:right;"> 46.68707 </td>
   <td style="text-align:right;"> 46.56386 </td>
   <td style="text-align:right;"> 0.9358 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.2408 </td>
   <td style="text-align:right;"> 0.2171 </td>
   <td style="text-align:right;"> 0.1855 </td>
   <td style="text-align:right;"> 0.0631 </td>
   <td style="text-align:right;"> 0.0877 </td>
   <td style="text-align:right;"> 0.0946 </td>
   <td style="text-align:right;"> 0.2655 </td>
   <td style="text-align:right;"> 0.3530 </td>
   <td style="text-align:right;"> 0.2191 </td>
   <td style="text-align:right;"> 0.0162 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.3218 </td>
   <td style="text-align:right;"> 0.4009 </td>
   <td style="text-align:right;"> 0.1241 </td>
   <td style="text-align:right;"> 0.7890 </td>
   <td style="text-align:right;"> 0.2265 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.2631 </td>
   <td style="text-align:right;"> 0.2719 </td>
   <td style="text-align:right;"> 0.0329 </td>
   <td style="text-align:right;"> 0.0004 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 25 </td>
   <td style="text-align:right;"> 825.6219 </td>
   <td style="text-align:right;"> 44.06669 </td>
   <td style="text-align:right;"> 40.09964 </td>
   <td style="text-align:right;"> 44.94290 </td>
   <td style="text-align:right;"> 48.77275 </td>
   <td style="text-align:right;"> 58.06502 </td>
   <td style="text-align:right;"> 58.22063 </td>
   <td style="text-align:right;"> 0.8102 </td>
   <td style="text-align:right;"> 0.4911 </td>
   <td style="text-align:right;"> 0.2463 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.1548 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 0.0832 </td>
   <td style="text-align:right;"> 0.3013 </td>
   <td style="text-align:right;"> 0.3378 </td>
   <td style="text-align:right;"> 0.1656 </td>
   <td style="text-align:right;"> 0.1140 </td>
   <td style="text-align:right;"> 0.7084 </td>
   <td style="text-align:right;"> 0.3795 </td>
   <td style="text-align:right;"> 0.5214 </td>
   <td style="text-align:right;"> 0.2912 </td>
   <td style="text-align:right;"> 0.8442 </td>
   <td style="text-align:right;"> 0.2300 </td>
   <td style="text-align:right;"> 0.8038 </td>
   <td style="text-align:right;"> 0.3002 </td>
   <td style="text-align:right;"> 0.2207 </td>
   <td style="text-align:right;"> 0.0477 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Diagrama de dispersión por las variables</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-2_49ff6688ee298b92492d91163627429f">
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-2-1.png" style="height:150.0%" width="672"></p>
</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-3_a092c6f9f377fa0004f05985493603d3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  vector[n] x;      <span class="sc">/</span><span class="er">/</span> Variable predictora</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  vector[n] y;      <span class="sc">/</span><span class="er">/</span> Variable respuesta</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  real b0;            <span class="sc">/</span><span class="er">/</span> Intercepto</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  real b1;            <span class="sc">/</span><span class="er">/</span> Pendiente</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma2;  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>transformed parameters{</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma;</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> <span class="fu">sqrt</span>(sigma2);</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  b0 <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>);</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  b1 <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>);</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="sc">~</span> <span class="fu">inv_gamma</span>(<span class="fl">0.0001</span>, <span class="fl">0.0001</span>);</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x, sigma);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">normal_rng</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x, sigma);</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-4_b0b14cb212ddb50957c844899d735179">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Definir el modelo</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#file.edit("../Data/modelosStan/7ModeloLm.stan")</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fitLm1 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/7ModeloLm.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-5_a9e3ee49b43f7fba68c9a28f4efeb886">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalm),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> datalm<span class="sc">$</span>material_paredes ,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalm<span class="sc">$</span>Promedio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-6_f06b39fd9fd6963ef36bf3d24d02b7e0">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model_fitLm1 <span class="ot">&lt;-</span> fitLm1<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 0.5 seconds.
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 0.4 seconds.
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 0.5 seconds.
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 0.4 seconds.

All 4 chains finished successfully.
Mean chain execution time: 0.5 seconds.
Total execution time: 0.7 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-7_603bdd08c4bad75a387189f1f8339cde">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_fitLm1<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"b0"</span>,<span class="st">"b1"</span>,<span class="st">"sigma2"</span>,<span class="st">"sigma"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> b0 </td>
   <td style="text-align:right;"> 1512.5094 </td>
   <td style="text-align:right;"> 1513.9300 </td>
   <td style="text-align:right;"> 108.7433 </td>
   <td style="text-align:right;"> 107.1104 </td>
   <td style="text-align:right;"> 1329.3045 </td>
   <td style="text-align:right;"> 1686.2350 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> b1 </td>
   <td style="text-align:right;"> -1002.7868 </td>
   <td style="text-align:right;"> -1003.6100 </td>
   <td style="text-align:right;"> 159.1293 </td>
   <td style="text-align:right;"> 156.1178 </td>
   <td style="text-align:right;"> -1259.9870 </td>
   <td style="text-align:right;"> -736.2472 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma2 </td>
   <td style="text-align:right;"> 16512.1436 </td>
   <td style="text-align:right;"> 15625.1500 </td>
   <td style="text-align:right;"> 5248.6712 </td>
   <td style="text-align:right;"> 4412.5882 </td>
   <td style="text-align:right;"> 9846.6020 </td>
   <td style="text-align:right;"> 26218.6850 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma </td>
   <td style="text-align:right;"> 127.0454 </td>
   <td style="text-align:right;"> 125.0005 </td>
   <td style="text-align:right;"> 19.2793 </td>
   <td style="text-align:right;"> 17.8164 </td>
   <td style="text-align:right;"> 99.2301 </td>
   <td style="text-align:right;"> 161.9222 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-8_113ea818d44a10574fd58021a3f0ed60">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)))<span class="sc">/</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-9_0905a0c43541c69daf3198789f693a53">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)))<span class="sc">/</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-10_c5fcc9e13c30f1345bbe8f433ee28b40">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)))<span class="sc">/</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-11_d14f17f5f0b37e22456e211751233cb3">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalm<span class="sc">$</span>Promedio), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="práctica-en-stan-modelo-lineal-múltiple" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-modelo-lineal-múltiple">Práctica en <strong>STAN</strong> (modelo lineal múltiple)</h3>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-12_f0f949deb9d5672d3356707da0a91eaa">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  vector[n] y;      <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma2;  <span class="sc">/</span><span class="er">/</span> error scale</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>transformed parameters{</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma;</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> <span class="fu">sqrt</span>(sigma2);</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="sc">~</span> <span class="fu">inv_gamma</span>(<span class="fl">0.0001</span>, <span class="fl">0.0001</span>);</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(x <span class="sc">*</span> beta, sigma);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">normal_rng</span>(x <span class="sc">*</span> beta, sigma);</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-13_9a281f605cd10c600faf8d435dc86e73">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/8ModeloLm.stan")</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fitLm2 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/8ModeloLm.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-14_689798c4538084ee6724ae962ef4875a">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Promedio <span class="sc">~</span> material_paredes <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                  alfabeta <span class="sc">+</span>  tiene_internet <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                  piso_tierra , <span class="at">data =</span> datalm)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8770 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.9557 </td>
   <td style="text-align:right;"> 0.4561 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7195 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.3548 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8614 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.9112 </td>
   <td style="text-align:right;"> 0.4614 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4504 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.6730 </td>
   <td style="text-align:right;"> 0.1097 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8350 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.8963 </td>
   <td style="text-align:right;"> 0.3885 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8342 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.9074 </td>
   <td style="text-align:right;"> 0.4849 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3474 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.5588 </td>
   <td style="text-align:right;"> 0.0494 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8193 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.8317 </td>
   <td style="text-align:right;"> 0.3994 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9256 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.9509 </td>
   <td style="text-align:right;"> 0.4499 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7909 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.8919 </td>
   <td style="text-align:right;"> 0.3942 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4882 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.1514 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6344 </td>
   <td style="text-align:right;"> 0.0672 </td>
   <td style="text-align:right;"> 0.8369 </td>
   <td style="text-align:right;"> 0.2871 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6297 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.7279 </td>
   <td style="text-align:right;"> 0.3038 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5532 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.7133 </td>
   <td style="text-align:right;"> 0.2459 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3305 </td>
   <td style="text-align:right;"> 0.0190 </td>
   <td style="text-align:right;"> 0.5290 </td>
   <td style="text-align:right;"> 0.0653 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6946 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.8734 </td>
   <td style="text-align:right;"> 0.2065 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5881 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 0.8375 </td>
   <td style="text-align:right;"> 0.1241 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5862 </td>
   <td style="text-align:right;"> 0.0380 </td>
   <td style="text-align:right;"> 0.7523 </td>
   <td style="text-align:right;"> 0.1941 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7307 </td>
   <td style="text-align:right;"> 0.0740 </td>
   <td style="text-align:right;"> 0.9052 </td>
   <td style="text-align:right;"> 0.2189 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5998 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.8252 </td>
   <td style="text-align:right;"> 0.4201 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7998 </td>
   <td style="text-align:right;"> 0.1069 </td>
   <td style="text-align:right;"> 0.9257 </td>
   <td style="text-align:right;"> 0.4117 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5983 </td>
   <td style="text-align:right;"> 0.0759 </td>
   <td style="text-align:right;"> 0.8555 </td>
   <td style="text-align:right;"> 0.3479 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4758 </td>
   <td style="text-align:right;"> 0.0318 </td>
   <td style="text-align:right;"> 0.7088 </td>
   <td style="text-align:right;"> 0.1765 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.0329 </td>
   <td style="text-align:right;"> 0.7890 </td>
   <td style="text-align:right;"> 0.2265 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8038 </td>
   <td style="text-align:right;"> 0.0477 </td>
   <td style="text-align:right;"> 0.8442 </td>
   <td style="text-align:right;"> 0.2300 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-15_1e0acc6a047f48050464087903b20e73">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalm),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalm<span class="sc">$</span>Promedio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-16_b80e7074fde5ab7cdab9dcef2e59d343">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_fitLm2 <span class="ot">&lt;-</span> fitLm2<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 2.0 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 2.2 seconds.
Chain 4 finished in 2.1 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 2.2 seconds.

All 4 chains finished successfully.
Mean chain execution time: 2.1 seconds.
Total execution time: 2.4 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-17_f9d8cce3cc174fcce5a58b06b84e3e04">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_fitLm2<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>,<span class="st">"sigma2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> 1584.3026 </td>
   <td style="text-align:right;"> 1585.2350 </td>
   <td style="text-align:right;"> 266.1771 </td>
   <td style="text-align:right;"> 254.8145 </td>
   <td style="text-align:right;"> 1140.2420 </td>
   <td style="text-align:right;"> 2004.1930 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -297.1282 </td>
   <td style="text-align:right;"> -295.2565 </td>
   <td style="text-align:right;"> 524.1862 </td>
   <td style="text-align:right;"> 508.2622 </td>
   <td style="text-align:right;"> -1158.9660 </td>
   <td style="text-align:right;"> 574.1820 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -1855.9432 </td>
   <td style="text-align:right;"> -1887.8900 </td>
   <td style="text-align:right;"> 1346.6887 </td>
   <td style="text-align:right;"> 1324.3006 </td>
   <td style="text-align:right;"> -3973.2315 </td>
   <td style="text-align:right;"> 376.3317 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -506.1595 </td>
   <td style="text-align:right;"> -519.8125 </td>
   <td style="text-align:right;"> 617.8417 </td>
   <td style="text-align:right;"> 612.8498 </td>
   <td style="text-align:right;"> -1495.9835 </td>
   <td style="text-align:right;"> 537.6469 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> 56.1126 </td>
   <td style="text-align:right;"> 49.4915 </td>
   <td style="text-align:right;"> 479.3088 </td>
   <td style="text-align:right;"> 469.4156 </td>
   <td style="text-align:right;"> -721.6479 </td>
   <td style="text-align:right;"> 845.5085 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma2 </td>
   <td style="text-align:right;"> 16446.9419 </td>
   <td style="text-align:right;"> 15319.5000 </td>
   <td style="text-align:right;"> 5872.7594 </td>
   <td style="text-align:right;"> 4842.6164 </td>
   <td style="text-align:right;"> 9308.9920 </td>
   <td style="text-align:right;"> 26964.1450 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-18_e450e8e0ddde89d294343a116119f2be">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)))<span class="sc">/</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-19_5afe6541b45ada17681940917fec4973">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)))<span class="sc">/</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-20_3bdec2020123c4ae8a5b6b25ccad7a0d">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)))<span class="sc">/</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-21_1748d1786c22fb0d959c09ca0acfa689">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)))<span class="sc">/</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-22_923df19fc4043d0902d90089cb8938bb">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)))<span class="sc">/</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-23_5e9bfae7e882de9599851aaf70f31f99">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom,]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalm<span class="sc">$</span>Promedio), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modelo-bernoulli-con-vínculo-logístico" class="level2">
<h2 class="anchored" data-anchor-id="modelo-bernoulli-con-vínculo-logístico">Modelo Bernoulli con vínculo logístico</h2>
<p>Este caso es típico en donde la variable respuesta sólo toma dos valores, uno en caso de un evento exitoso y cero, cuando se presenta un fracaso. Se supone que <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> es un conjunto de variables aleatorias intercambiables cada una con distribución bernoulli de parámetro <span class="math inline">\(\theta_i\)</span>, y se quiere estudiar la relación entre <span class="math inline">\(\theta_i\)</span> y las variables auxiliares <span class="math inline">\(\mathbf{X}_i\)</span> por medio de la función de enlace <span class="math inline">\(g(\theta_i)=\mathbf{X}_i'\boldsymbol{\beta}\)</span>. Aquí consideramos la función de enlace logística</p>
<p><span class="math display">\[
\begin{equation}
\eta_i=g(\theta_i)=logit(\theta_i)=\log\left(\frac{\theta_i}{1-\theta_i}\right)
\end{equation}
\]</span></p>
<p>fácilmente se encuentra que la función inversa para <span class="math inline">\(g(\cdot)\)</span>, está dada por</p>
<p><span class="math display">\[
\begin{equation*}
\theta_i=g^{-1}(\eta_i)=\frac{\exp(\eta_i)}{1+\exp(\eta_i)}
\end{equation*}
\]</span></p>
<p>Notando que <span class="math inline">\(\eta_i=\mathbf{X}_i'\boldsymbol{\beta}\)</span> y siguiendo con el modelamiento, se tiene que la verosimilitud de los datos está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\mathbf{Y}\mid \boldsymbol{\theta})&amp;=\prod_{i=1}^n\theta_i^{y_i}(1-\theta_i)^{1-y_i} \notag \\
p(\mathbf{Y}\mid \boldsymbol{\beta})&amp;=\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{1-y_i}
\end{align}
\]</span></p>
<p>Suponga que la distribución a previa para <span class="math inline">\(\boldsymbol{\beta}\)</span> está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}\sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span></p>
<p>De esta manera, la distribución a posterior toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta} \mid \mathbf{Y}, \mathbf{X})&amp;\propto
\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{1-y_i}\\
&amp;\hspace{2cm}\times
\exp\left\{\frac{-1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>La anterior expresión no tiene una forma cerrada y no es sencillo, en primera instancia, simular observaciones u obtener inferencias a posterior.</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-24_ae5e9abbbf63bfe97178e5159e676e8a">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>datalogit <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    depto,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pobreza =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo =</span> <span class="fu">as_factor</span>(sexo),  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">anoest =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">|</span> <span class="fu">is.na</span>(anoest)   <span class="sc">~</span> <span class="st">"98"</span>  , <span class="co">#No aplica</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"99"</span>, <span class="co">#NS/NR</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">==</span> <span class="dv">0</span>  <span class="sc">~</span> <span class="st">"1"</span>, <span class="co"># Sin educacion</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">~</span> <span class="st">"2"</span>,       <span class="co"># 1 - 6</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">~</span> <span class="st">"3"</span>,      <span class="co"># 7 - 12</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"4"</span> ),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">edad =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">~</span> <span class="st">"3"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">~</span> <span class="st">"4"</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"5"</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(depto <span class="sc">==</span><span class="st">"02"</span>, anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(datalogit, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:right;"> pobreza </th>
   <th style="text-align:left;"> sexo </th>
   <th style="text-align:left;"> anoest </th>
   <th style="text-align:left;"> edad </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="práctica-en-stan" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan">Práctica en <strong>STAN</strong></h3>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-25_2a4ccbdab4d935494b33f4e7f6fd6e49">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  int y;      <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    vector[n] inv_eta;</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>   inv_eta <span class="ot">=</span> <span class="fu">inv_logit</span>(x <span class="sc">*</span> beta);</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">bernoulli</span>(inv_eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">bernoulli_rng</span>(inv_eta);</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-26_9d82ab7266728d282ea1e30535466257">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/9ModeloLogit.stan")</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fitLosgit1 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/9ModeloLogit.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-27_4a4cbb3aea8bb33082c3abf3a60a1f14">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(pobreza <span class="sc">~</span> sexo <span class="sc">+</span> anoest <span class="sc">+</span> edad,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> datalogit)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(Xdat, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> sexoMujer </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-28_76f97d2de6169c42de6069fcde4b50d2">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalogit),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalogit<span class="sc">$</span>pobreza)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-29_09d01d443f615169378cad850878aa39">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model_Losgit1 <span class="ot">&lt;-</span> fitLosgit1<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 24.7 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 25.4 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 25.9 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 26.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 25.5 seconds.
Total execution time: 26.2 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-30_2989e2ecd059c479850a794e09520e58">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model_Losgit1<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> -0.2935 </td>
   <td style="text-align:right;"> -0.2884 </td>
   <td style="text-align:right;"> 0.2201 </td>
   <td style="text-align:right;"> 0.2236 </td>
   <td style="text-align:right;"> -0.6682 </td>
   <td style="text-align:right;"> 0.0592 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -0.1297 </td>
   <td style="text-align:right;"> -0.1306 </td>
   <td style="text-align:right;"> 0.1086 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> -0.3091 </td>
   <td style="text-align:right;"> 0.0495 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -0.4980 </td>
   <td style="text-align:right;"> -0.4984 </td>
   <td style="text-align:right;"> 0.1599 </td>
   <td style="text-align:right;"> 0.1573 </td>
   <td style="text-align:right;"> -0.7582 </td>
   <td style="text-align:right;"> -0.2329 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -1.1634 </td>
   <td style="text-align:right;"> -1.1687 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.1767 </td>
   <td style="text-align:right;"> -1.4522 </td>
   <td style="text-align:right;"> -0.8648 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -2.6935 </td>
   <td style="text-align:right;"> -2.6936 </td>
   <td style="text-align:right;"> 0.2274 </td>
   <td style="text-align:right;"> 0.2299 </td>
   <td style="text-align:right;"> -3.0650 </td>
   <td style="text-align:right;"> -2.3230 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> 0.2661 </td>
   <td style="text-align:right;"> 0.2651 </td>
   <td style="text-align:right;"> 0.1599 </td>
   <td style="text-align:right;"> 0.1607 </td>
   <td style="text-align:right;"> 0.0092 </td>
   <td style="text-align:right;"> 0.5343 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.5625 </td>
   <td style="text-align:right;"> -0.5616 </td>
   <td style="text-align:right;"> 0.1694 </td>
   <td style="text-align:right;"> 0.1695 </td>
   <td style="text-align:right;"> -0.8443 </td>
   <td style="text-align:right;"> -0.2883 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> -1.1337 </td>
   <td style="text-align:right;"> -1.1356 </td>
   <td style="text-align:right;"> 0.2004 </td>
   <td style="text-align:right;"> 0.1984 </td>
   <td style="text-align:right;"> -1.4631 </td>
   <td style="text-align:right;"> -0.8035 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-31_8d0d0cf34aff26965c8287dec44ce9a0">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-32_29b7cb9bb37e6aa2fc1d7e423320ff8f">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-33_00b9600ff98d33dd305997c5e7750cb9">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalogit<span class="sc">$</span>pobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Una alternativa es hacer el siguiente modelo que utiliza la función <code>bernoulli_logit</code></p>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-34_414c38f573798d2b812faa138505b7d2">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>,upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> y[n];       <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>   vector[n] eta;</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>   eta <span class="ot">=</span> x <span class="sc">*</span> beta;</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">bernoulli_logit</span>(eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">bernoulli_logit_rng</span>(eta);</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-35_234dee0e5a35f8fe466ba6562ec6aed7">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/10ModeloLogit.stan")</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fitLosgit2 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/10ModeloLogit.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-36_2535a66dc2fa278885f1c284bd1ad8b7">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model_Losgit2 <span class="ot">&lt;-</span> fitLosgit2<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 18.2 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 18.6 seconds.
Chain 3 finished in 18.6 seconds.
Chain 4 finished in 18.6 seconds.

All 4 chains finished successfully.
Mean chain execution time: 18.5 seconds.
Total execution time: 18.7 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-37_9be2d4c22bbf2f835433299be3c9b49b">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>model_Losgit2<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> -0.2868 </td>
   <td style="text-align:right;"> -0.2875 </td>
   <td style="text-align:right;"> 0.2213 </td>
   <td style="text-align:right;"> 0.2199 </td>
   <td style="text-align:right;"> -0.6515 </td>
   <td style="text-align:right;"> 0.0794 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -0.1335 </td>
   <td style="text-align:right;"> -0.1310 </td>
   <td style="text-align:right;"> 0.1057 </td>
   <td style="text-align:right;"> 0.1063 </td>
   <td style="text-align:right;"> -0.3070 </td>
   <td style="text-align:right;"> 0.0411 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -0.4993 </td>
   <td style="text-align:right;"> -0.4960 </td>
   <td style="text-align:right;"> 0.1603 </td>
   <td style="text-align:right;"> 0.1601 </td>
   <td style="text-align:right;"> -0.7633 </td>
   <td style="text-align:right;"> -0.2402 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -1.1692 </td>
   <td style="text-align:right;"> -1.1702 </td>
   <td style="text-align:right;"> 0.1796 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> -1.4632 </td>
   <td style="text-align:right;"> -0.8712 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -2.7010 </td>
   <td style="text-align:right;"> -2.6954 </td>
   <td style="text-align:right;"> 0.2342 </td>
   <td style="text-align:right;"> 0.2324 </td>
   <td style="text-align:right;"> -3.1069 </td>
   <td style="text-align:right;"> -2.3229 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> 0.2673 </td>
   <td style="text-align:right;"> 0.2690 </td>
   <td style="text-align:right;"> 0.1557 </td>
   <td style="text-align:right;"> 0.1516 </td>
   <td style="text-align:right;"> 0.0070 </td>
   <td style="text-align:right;"> 0.5235 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.5640 </td>
   <td style="text-align:right;"> -0.5629 </td>
   <td style="text-align:right;"> 0.1664 </td>
   <td style="text-align:right;"> 0.1625 </td>
   <td style="text-align:right;"> -0.8421 </td>
   <td style="text-align:right;"> -0.2915 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> -1.1354 </td>
   <td style="text-align:right;"> -1.1307 </td>
   <td style="text-align:right;"> 0.2015 </td>
   <td style="text-align:right;"> 0.2064 </td>
   <td style="text-align:right;"> -1.4675 </td>
   <td style="text-align:right;"> -0.8106 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-38_85b518e965d3ce2aa8d581f0f2242ccb">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-39_07f5c30311967f3363a46273b79656a1">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-40_bca75c92d8882a85d3ece2fb011d8363">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalogit<span class="sc">$</span>pobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modelo-binomial" class="level2">
<h2 class="anchored" data-anchor-id="modelo-binomial">Modelo Binomial</h2>
<p>En este caso la variable respuesta representa conteos de éxitos que se tuvieron en un conjunto de distintos experimentos. Se supone que <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> es un conjunto de variables aleatorias intercambiables cada una con distribución binomial de parámetro <span class="math inline">\(\theta_i\)</span> y <span class="math inline">\(n_i\)</span>. El modelo binomial busca relacionar las probabilidades de éxito <span class="math inline">\(\theta_i\)</span> con variables auxiliares <span class="math inline">\(\mathbf{X}_i\)</span>. Se considera a continuación la función de enlace logística.</p>
<p>La función de vínculo logística dada por <span class="math inline">\(g(\theta_i)=\log\left(\frac{\theta_i}{1-\theta_i}\right)\)</span>, y denotando <span class="math inline">\(\eta_i=\mathbf{X}_i'\boldsymbol{\beta}=g(\theta_i)\)</span>, se tiene que la verosimilitud de los datos está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\mathbf{Y}\mid \boldsymbol{\theta})&amp;=\prod_{i=1}^n\binom{n}{y_i}\theta_i^{y_i}(1-\theta_i)^{n-y_i} \notag \\
&amp;=\prod_{i=1}^n\binom{n}{y_i}\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{n-y_i}
\end{align}
\]</span> Suponga que la distribución a previa para <span class="math inline">\(\boldsymbol{\beta}\)</span> está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}\sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span> De esta manera, la distribución a posterior toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta} \mid \mathbf{Y}, \mathbf{X})&amp;\propto
\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{n-y_i}\\
&amp;\hspace{2cm}\times
\exp\left\{\frac{-1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>Una vez más, la anterior expresión no tiene una forma cerrada.</p>
<section id="práctica-en-stan-1" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-1">Práctica en <code>STAN</code></h3>
<p>Datos de la encuesta</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-41_02697f6517284d0cfd54324da7124475">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dataBino <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    depto,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pobreza =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(depto) <span class="sc">%&gt;%</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>() ,                  <span class="co"># Número de ensayos</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nPobreza =</span> <span class="fu">sum</span>(pobreza)    <span class="co"># número de exitos </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span>                      <span class="co"># covariables  </span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"depto"</span>) </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(dataBino,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> nPobreza </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivo </th>
   <th style="text-align:right;"> suelo_urbano </th>
   <th style="text-align:right;"> modificacion_humana </th>
   <th style="text-align:right;"> tiempo_hospital </th>
   <th style="text-align:right;"> tiempo_hospital_caminando </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> discapacidad1 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 2649 </td>
   <td style="text-align:right;"> 474 </td>
   <td style="text-align:right;"> 41.76282 </td>
   <td style="text-align:right;"> 43.48416 </td>
   <td style="text-align:right;"> 43.57739 </td>
   <td style="text-align:right;"> 46.97255 </td>
   <td style="text-align:right;"> 48.64957 </td>
   <td style="text-align:right;"> 48.29499 </td>
   <td style="text-align:right;"> 0.4935 </td>
   <td style="text-align:right;"> 0.4934 </td>
   <td style="text-align:right;"> 0.2356 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.1665 </td>
   <td style="text-align:right;"> 0.0709 </td>
   <td style="text-align:right;"> 0.0246 </td>
   <td style="text-align:right;"> 0.0876 </td>
   <td style="text-align:right;"> 0.3958 </td>
   <td style="text-align:right;"> 0.2696 </td>
   <td style="text-align:right;"> 0.1188 </td>
   <td style="text-align:right;"> 0.1205 </td>
   <td style="text-align:right;"> 0.6632 </td>
   <td style="text-align:right;"> 0.4585 </td>
   <td style="text-align:right;"> 0.4646 </td>
   <td style="text-align:right;"> 0.5092 </td>
   <td style="text-align:right;"> 0.9557 </td>
   <td style="text-align:right;"> 0.4561 </td>
   <td style="text-align:right;"> 0.8770 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.1621 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 3179 </td>
   <td style="text-align:right;"> 489 </td>
   <td style="text-align:right;"> 51.61811 </td>
   <td style="text-align:right;"> 51.73498 </td>
   <td style="text-align:right;"> 52.22498 </td>
   <td style="text-align:right;"> 52.46159 </td>
   <td style="text-align:right;"> 46.91322 </td>
   <td style="text-align:right;"> 46.96396 </td>
   <td style="text-align:right;"> 0.7076 </td>
   <td style="text-align:right;"> 0.5038 </td>
   <td style="text-align:right;"> 0.2358 </td>
   <td style="text-align:right;"> 0.2060 </td>
   <td style="text-align:right;"> 0.1898 </td>
   <td style="text-align:right;"> 0.0984 </td>
   <td style="text-align:right;"> 0.0245 </td>
   <td style="text-align:right;"> 0.1134 </td>
   <td style="text-align:right;"> 0.2831 </td>
   <td style="text-align:right;"> 0.3200 </td>
   <td style="text-align:right;"> 0.2018 </td>
   <td style="text-align:right;"> 0.2715 </td>
   <td style="text-align:right;"> 0.5615 </td>
   <td style="text-align:right;"> 0.3902 </td>
   <td style="text-align:right;"> 0.4254 </td>
   <td style="text-align:right;"> 0.4013 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.3548 </td>
   <td style="text-align:right;"> 0.7195 </td>
   <td style="text-align:right;"> 0.3978 </td>
   <td style="text-align:right;"> 0.2530 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.0021 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 1961 </td>
   <td style="text-align:right;"> 352 </td>
   <td style="text-align:right;"> 44.50173 </td>
   <td style="text-align:right;"> 50.32670 </td>
   <td style="text-align:right;"> 47.42621 </td>
   <td style="text-align:right;"> 46.64527 </td>
   <td style="text-align:right;"> 46.80769 </td>
   <td style="text-align:right;"> 46.90296 </td>
   <td style="text-align:right;"> 0.5736 </td>
   <td style="text-align:right;"> 0.5019 </td>
   <td style="text-align:right;"> 0.2427 </td>
   <td style="text-align:right;"> 0.1974 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.0936 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 0.1078 </td>
   <td style="text-align:right;"> 0.2814 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.1768 </td>
   <td style="text-align:right;"> 0.6764 </td>
   <td style="text-align:right;"> 0.6685 </td>
   <td style="text-align:right;"> 0.4673 </td>
   <td style="text-align:right;"> 0.4394 </td>
   <td style="text-align:right;"> 0.5544 </td>
   <td style="text-align:right;"> 0.9112 </td>
   <td style="text-align:right;"> 0.4614 </td>
   <td style="text-align:right;"> 0.8614 </td>
   <td style="text-align:right;"> 0.3859 </td>
   <td style="text-align:right;"> 0.2267 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 3446 </td>
   <td style="text-align:right;"> 269 </td>
   <td style="text-align:right;"> 59.90582 </td>
   <td style="text-align:right;"> 49.27408 </td>
   <td style="text-align:right;"> 57.20224 </td>
   <td style="text-align:right;"> 53.91574 </td>
   <td style="text-align:right;"> 47.41502 </td>
   <td style="text-align:right;"> 48.26891 </td>
   <td style="text-align:right;"> 0.9475 </td>
   <td style="text-align:right;"> 0.5062 </td>
   <td style="text-align:right;"> 0.2555 </td>
   <td style="text-align:right;"> 0.2263 </td>
   <td style="text-align:right;"> 0.1951 </td>
   <td style="text-align:right;"> 0.0862 </td>
   <td style="text-align:right;"> 0.0176 </td>
   <td style="text-align:right;"> 0.1089 </td>
   <td style="text-align:right;"> 0.1919 </td>
   <td style="text-align:right;"> 0.3300 </td>
   <td style="text-align:right;"> 0.3409 </td>
   <td style="text-align:right;"> 0.2828 </td>
   <td style="text-align:right;"> 0.5233 </td>
   <td style="text-align:right;"> 0.3959 </td>
   <td style="text-align:right;"> 0.4762 </td>
   <td style="text-align:right;"> 0.1053 </td>
   <td style="text-align:right;"> 0.6730 </td>
   <td style="text-align:right;"> 0.1097 </td>
   <td style="text-align:right;"> 0.4504 </td>
   <td style="text-align:right;"> 0.3622 </td>
   <td style="text-align:right;"> 0.4055 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.0031 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 2249 </td>
   <td style="text-align:right;"> 575 </td>
   <td style="text-align:right;"> 45.89331 </td>
   <td style="text-align:right;"> 56.07571 </td>
   <td style="text-align:right;"> 51.20286 </td>
   <td style="text-align:right;"> 54.72841 </td>
   <td style="text-align:right;"> 46.98491 </td>
   <td style="text-align:right;"> 47.21079 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.5022 </td>
   <td style="text-align:right;"> 0.2572 </td>
   <td style="text-align:right;"> 0.2016 </td>
   <td style="text-align:right;"> 0.1690 </td>
   <td style="text-align:right;"> 0.0867 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.1031 </td>
   <td style="text-align:right;"> 0.2907 </td>
   <td style="text-align:right;"> 0.3176 </td>
   <td style="text-align:right;"> 0.1788 </td>
   <td style="text-align:right;"> 0.6347 </td>
   <td style="text-align:right;"> 0.6610 </td>
   <td style="text-align:right;"> 0.4961 </td>
   <td style="text-align:right;"> 0.4794 </td>
   <td style="text-align:right;"> 0.4565 </td>
   <td style="text-align:right;"> 0.8963 </td>
   <td style="text-align:right;"> 0.3885 </td>
   <td style="text-align:right;"> 0.8350 </td>
   <td style="text-align:right;"> 0.4089 </td>
   <td style="text-align:right;"> 0.2332 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 2912 </td>
   <td style="text-align:right;"> 787 </td>
   <td style="text-align:right;"> 49.07049 </td>
   <td style="text-align:right;"> 59.98774 </td>
   <td style="text-align:right;"> 49.65565 </td>
   <td style="text-align:right;"> 60.15467 </td>
   <td style="text-align:right;"> 47.03441 </td>
   <td style="text-align:right;"> 46.95647 </td>
   <td style="text-align:right;"> 0.3973 </td>
   <td style="text-align:right;"> 0.5059 </td>
   <td style="text-align:right;"> 0.2341 </td>
   <td style="text-align:right;"> 0.2086 </td>
   <td style="text-align:right;"> 0.1755 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.0447 </td>
   <td style="text-align:right;"> 0.0838 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2494 </td>
   <td style="text-align:right;"> 0.1299 </td>
   <td style="text-align:right;"> 0.0501 </td>
   <td style="text-align:right;"> 0.7166 </td>
   <td style="text-align:right;"> 0.3984 </td>
   <td style="text-align:right;"> 0.4466 </td>
   <td style="text-align:right;"> 0.5917 </td>
   <td style="text-align:right;"> 0.9074 </td>
   <td style="text-align:right;"> 0.4849 </td>
   <td style="text-align:right;"> 0.8342 </td>
   <td style="text-align:right;"> 0.2641 </td>
   <td style="text-align:right;"> 0.1689 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.0019 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 2410 </td>
   <td style="text-align:right;"> 261 </td>
   <td style="text-align:right;"> 43.14251 </td>
   <td style="text-align:right;"> 39.11361 </td>
   <td style="text-align:right;"> 44.11616 </td>
   <td style="text-align:right;"> 33.01350 </td>
   <td style="text-align:right;"> 46.65175 </td>
   <td style="text-align:right;"> 46.49964 </td>
   <td style="text-align:right;"> 1.0000 </td>
   <td style="text-align:right;"> 0.5082 </td>
   <td style="text-align:right;"> 0.2514 </td>
   <td style="text-align:right;"> 0.2260 </td>
   <td style="text-align:right;"> 0.1947 </td>
   <td style="text-align:right;"> 0.0831 </td>
   <td style="text-align:right;"> 0.0385 </td>
   <td style="text-align:right;"> 0.1096 </td>
   <td style="text-align:right;"> 0.1802 </td>
   <td style="text-align:right;"> 0.3999 </td>
   <td style="text-align:right;"> 0.2936 </td>
   <td style="text-align:right;"> 0.0891 </td>
   <td style="text-align:right;"> 0.2251 </td>
   <td style="text-align:right;"> 0.1480 </td>
   <td style="text-align:right;"> 0.2344 </td>
   <td style="text-align:right;"> 0.1327 </td>
   <td style="text-align:right;"> 0.5588 </td>
   <td style="text-align:right;"> 0.0494 </td>
   <td style="text-align:right;"> 0.3474 </td>
   <td style="text-align:right;"> 0.1623 </td>
   <td style="text-align:right;"> 0.3348 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.0022 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 2674 </td>
   <td style="text-align:right;"> 496 </td>
   <td style="text-align:right;"> 52.56436 </td>
   <td style="text-align:right;"> 62.71131 </td>
   <td style="text-align:right;"> 60.31193 </td>
   <td style="text-align:right;"> 66.57010 </td>
   <td style="text-align:right;"> 48.93218 </td>
   <td style="text-align:right;"> 48.67928 </td>
   <td style="text-align:right;"> 0.6583 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.2583 </td>
   <td style="text-align:right;"> 0.2098 </td>
   <td style="text-align:right;"> 0.1828 </td>
   <td style="text-align:right;"> 0.0769 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 0.1099 </td>
   <td style="text-align:right;"> 0.2629 </td>
   <td style="text-align:right;"> 0.3185 </td>
   <td style="text-align:right;"> 0.2247 </td>
   <td style="text-align:right;"> 0.6015 </td>
   <td style="text-align:right;"> 0.5666 </td>
   <td style="text-align:right;"> 0.4046 </td>
   <td style="text-align:right;"> 0.4238 </td>
   <td style="text-align:right;"> 0.3837 </td>
   <td style="text-align:right;"> 0.8317 </td>
   <td style="text-align:right;"> 0.3994 </td>
   <td style="text-align:right;"> 0.8193 </td>
   <td style="text-align:right;"> 0.3390 </td>
   <td style="text-align:right;"> 0.2841 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.0030 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 2051 </td>
   <td style="text-align:right;"> 583 </td>
   <td style="text-align:right;"> 43.03490 </td>
   <td style="text-align:right;"> 50.59430 </td>
   <td style="text-align:right;"> 46.46389 </td>
   <td style="text-align:right;"> 45.49424 </td>
   <td style="text-align:right;"> 46.81505 </td>
   <td style="text-align:right;"> 46.97287 </td>
   <td style="text-align:right;"> 0.4524 </td>
   <td style="text-align:right;"> 0.5106 </td>
   <td style="text-align:right;"> 0.2438 </td>
   <td style="text-align:right;"> 0.1815 </td>
   <td style="text-align:right;"> 0.1762 </td>
   <td style="text-align:right;"> 0.0950 </td>
   <td style="text-align:right;"> 0.0006 </td>
   <td style="text-align:right;"> 0.0957 </td>
   <td style="text-align:right;"> 0.3205 </td>
   <td style="text-align:right;"> 0.3030 </td>
   <td style="text-align:right;"> 0.1303 </td>
   <td style="text-align:right;"> 0.6221 </td>
   <td style="text-align:right;"> 0.7762 </td>
   <td style="text-align:right;"> 0.5457 </td>
   <td style="text-align:right;"> 0.5703 </td>
   <td style="text-align:right;"> 0.6550 </td>
   <td style="text-align:right;"> 0.9509 </td>
   <td style="text-align:right;"> 0.4499 </td>
   <td style="text-align:right;"> 0.9256 </td>
   <td style="text-align:right;"> 0.4459 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.0006 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 2595 </td>
   <td style="text-align:right;"> 603 </td>
   <td style="text-align:right;"> 43.40122 </td>
   <td style="text-align:right;"> 49.46332 </td>
   <td style="text-align:right;"> 44.96708 </td>
   <td style="text-align:right;"> 51.97994 </td>
   <td style="text-align:right;"> 47.62130 </td>
   <td style="text-align:right;"> 47.50204 </td>
   <td style="text-align:right;"> 0.5890 </td>
   <td style="text-align:right;"> 0.5016 </td>
   <td style="text-align:right;"> 0.2549 </td>
   <td style="text-align:right;"> 0.1987 </td>
   <td style="text-align:right;"> 0.1696 </td>
   <td style="text-align:right;"> 0.0746 </td>
   <td style="text-align:right;"> 0.0174 </td>
   <td style="text-align:right;"> 0.0933 </td>
   <td style="text-align:right;"> 0.3327 </td>
   <td style="text-align:right;"> 0.2876 </td>
   <td style="text-align:right;"> 0.1622 </td>
   <td style="text-align:right;"> 0.3336 </td>
   <td style="text-align:right;"> 0.6983 </td>
   <td style="text-align:right;"> 0.4822 </td>
   <td style="text-align:right;"> 0.5781 </td>
   <td style="text-align:right;"> 0.5009 </td>
   <td style="text-align:right;"> 0.8919 </td>
   <td style="text-align:right;"> 0.3942 </td>
   <td style="text-align:right;"> 0.7909 </td>
   <td style="text-align:right;"> 0.3321 </td>
   <td style="text-align:right;"> 0.2194 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-42_1a0b96cf17ed92494f395c39d8bd9f02">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> D;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nd[D];  <span class="sc">/</span><span class="er">/</span> Número de ensayos</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> yd[D];   <span class="sc">/</span><span class="er">/</span> Número de exitos</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  matrix[D, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>   vector[D] eta;</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>   eta <span class="ot">=</span>  x <span class="sc">*</span> beta;</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  yd <span class="sc">~</span> <span class="fu">binomial_logit</span>(nd, eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    real ypred[D];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  ypred <span class="ot">=</span> <span class="fu">binomial_rng</span>(nd, <span class="fu">inv_logit</span>(eta));  </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-43_baef160ba3bbd4988dbca00109626302">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/11ModeloBinomial.stan")</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fitBinomial <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/11ModeloBinomial.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-44_a18cbceaf628c8e63cb2cd115bfa7776">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(nPobreza <span class="sc">~</span>  material_paredes <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                      alfabeta <span class="sc">+</span>  tiene_internet <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                      piso_tierra <span class="sc">+</span> piso_tierra <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                       rezago_escolar  <span class="sc">+</span> tiene_alcantarillado <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                       tiene_electricidad ,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> dataBino)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8770 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.9557 </td>
   <td style="text-align:right;"> 0.4561 </td>
   <td style="text-align:right;"> 0.1621 </td>
   <td style="text-align:right;"> 0.6632 </td>
   <td style="text-align:right;"> 0.4585 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7195 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.3548 </td>
   <td style="text-align:right;"> 0.2530 </td>
   <td style="text-align:right;"> 0.5615 </td>
   <td style="text-align:right;"> 0.3902 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8614 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.9112 </td>
   <td style="text-align:right;"> 0.4614 </td>
   <td style="text-align:right;"> 0.2267 </td>
   <td style="text-align:right;"> 0.6685 </td>
   <td style="text-align:right;"> 0.4673 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4504 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.6730 </td>
   <td style="text-align:right;"> 0.1097 </td>
   <td style="text-align:right;"> 0.4055 </td>
   <td style="text-align:right;"> 0.5233 </td>
   <td style="text-align:right;"> 0.3959 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8350 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.8963 </td>
   <td style="text-align:right;"> 0.3885 </td>
   <td style="text-align:right;"> 0.2332 </td>
   <td style="text-align:right;"> 0.6610 </td>
   <td style="text-align:right;"> 0.4961 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8342 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.9074 </td>
   <td style="text-align:right;"> 0.4849 </td>
   <td style="text-align:right;"> 0.1689 </td>
   <td style="text-align:right;"> 0.7166 </td>
   <td style="text-align:right;"> 0.3984 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3474 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.5588 </td>
   <td style="text-align:right;"> 0.0494 </td>
   <td style="text-align:right;"> 0.3348 </td>
   <td style="text-align:right;"> 0.2251 </td>
   <td style="text-align:right;"> 0.1480 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8193 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.8317 </td>
   <td style="text-align:right;"> 0.3994 </td>
   <td style="text-align:right;"> 0.2841 </td>
   <td style="text-align:right;"> 0.5666 </td>
   <td style="text-align:right;"> 0.4046 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9256 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.9509 </td>
   <td style="text-align:right;"> 0.4499 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.7762 </td>
   <td style="text-align:right;"> 0.5457 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7909 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.8919 </td>
   <td style="text-align:right;"> 0.3942 </td>
   <td style="text-align:right;"> 0.2194 </td>
   <td style="text-align:right;"> 0.6983 </td>
   <td style="text-align:right;"> 0.4822 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4882 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.1514 </td>
   <td style="text-align:right;"> 0.3519 </td>
   <td style="text-align:right;"> 0.4299 </td>
   <td style="text-align:right;"> 0.3302 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6344 </td>
   <td style="text-align:right;"> 0.0672 </td>
   <td style="text-align:right;"> 0.8369 </td>
   <td style="text-align:right;"> 0.2871 </td>
   <td style="text-align:right;"> 0.2859 </td>
   <td style="text-align:right;"> 0.5502 </td>
   <td style="text-align:right;"> 0.3712 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6297 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.7279 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.2819 </td>
   <td style="text-align:right;"> 0.4550 </td>
   <td style="text-align:right;"> 0.2852 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5532 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.7133 </td>
   <td style="text-align:right;"> 0.2459 </td>
   <td style="text-align:right;"> 0.2836 </td>
   <td style="text-align:right;"> 0.4177 </td>
   <td style="text-align:right;"> 0.2505 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.3305 </td>
   <td style="text-align:right;"> 0.0190 </td>
   <td style="text-align:right;"> 0.5290 </td>
   <td style="text-align:right;"> 0.0653 </td>
   <td style="text-align:right;"> 0.3871 </td>
   <td style="text-align:right;"> 0.2911 </td>
   <td style="text-align:right;"> 0.2261 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6946 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.8734 </td>
   <td style="text-align:right;"> 0.2065 </td>
   <td style="text-align:right;"> 0.2046 </td>
   <td style="text-align:right;"> 0.6410 </td>
   <td style="text-align:right;"> 0.3610 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5881 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 0.8375 </td>
   <td style="text-align:right;"> 0.1241 </td>
   <td style="text-align:right;"> 0.2513 </td>
   <td style="text-align:right;"> 0.6473 </td>
   <td style="text-align:right;"> 0.3646 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5862 </td>
   <td style="text-align:right;"> 0.0380 </td>
   <td style="text-align:right;"> 0.7523 </td>
   <td style="text-align:right;"> 0.1941 </td>
   <td style="text-align:right;"> 0.3988 </td>
   <td style="text-align:right;"> 0.4871 </td>
   <td style="text-align:right;"> 0.4154 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7307 </td>
   <td style="text-align:right;"> 0.0740 </td>
   <td style="text-align:right;"> 0.9052 </td>
   <td style="text-align:right;"> 0.2189 </td>
   <td style="text-align:right;"> 0.2630 </td>
   <td style="text-align:right;"> 0.6308 </td>
   <td style="text-align:right;"> 0.4806 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5998 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.8252 </td>
   <td style="text-align:right;"> 0.4201 </td>
   <td style="text-align:right;"> 0.2370 </td>
   <td style="text-align:right;"> 0.5524 </td>
   <td style="text-align:right;"> 0.2797 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7998 </td>
   <td style="text-align:right;"> 0.1069 </td>
   <td style="text-align:right;"> 0.9257 </td>
   <td style="text-align:right;"> 0.4117 </td>
   <td style="text-align:right;"> 0.2281 </td>
   <td style="text-align:right;"> 0.7726 </td>
   <td style="text-align:right;"> 0.5274 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5983 </td>
   <td style="text-align:right;"> 0.0759 </td>
   <td style="text-align:right;"> 0.8555 </td>
   <td style="text-align:right;"> 0.3479 </td>
   <td style="text-align:right;"> 0.1825 </td>
   <td style="text-align:right;"> 0.6316 </td>
   <td style="text-align:right;"> 0.2968 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.4758 </td>
   <td style="text-align:right;"> 0.0318 </td>
   <td style="text-align:right;"> 0.7088 </td>
   <td style="text-align:right;"> 0.1765 </td>
   <td style="text-align:right;"> 0.3608 </td>
   <td style="text-align:right;"> 0.5167 </td>
   <td style="text-align:right;"> 0.4417 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.0329 </td>
   <td style="text-align:right;"> 0.7890 </td>
   <td style="text-align:right;"> 0.2265 </td>
   <td style="text-align:right;"> 0.2719 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.3218 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8038 </td>
   <td style="text-align:right;"> 0.0477 </td>
   <td style="text-align:right;"> 0.8442 </td>
   <td style="text-align:right;"> 0.2300 </td>
   <td style="text-align:right;"> 0.2207 </td>
   <td style="text-align:right;"> 0.7084 </td>
   <td style="text-align:right;"> 0.3795 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-45_5312005443729e26ff52ca96327d4512">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">D =</span> <span class="fu">nrow</span>(dataBino),</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">yd =</span> dataBino<span class="sc">$</span>nPobreza,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nd =</span> dataBino<span class="sc">$</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-46_104aeed6279047af084f5d96a24b0348">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model_Binomial <span class="ot">&lt;-</span> fitBinomial<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sample_data, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 4.5 seconds.
Chain 4 finished in 4.5 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 4.7 seconds.
Chain 3 finished in 4.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 4.6 seconds.
Total execution time: 4.9 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-47_f697462dcffa2ba8c3567aca7e3efb98">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>model_Binomial<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> 1.1174 </td>
   <td style="text-align:right;"> 1.1163 </td>
   <td style="text-align:right;"> 0.3295 </td>
   <td style="text-align:right;"> 0.3287 </td>
   <td style="text-align:right;"> 0.5924 </td>
   <td style="text-align:right;"> 1.6606 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> 0.1791 </td>
   <td style="text-align:right;"> 0.1818 </td>
   <td style="text-align:right;"> 0.2246 </td>
   <td style="text-align:right;"> 0.2241 </td>
   <td style="text-align:right;"> -0.1841 </td>
   <td style="text-align:right;"> 0.5424 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> 4.6101 </td>
   <td style="text-align:right;"> 4.6047 </td>
   <td style="text-align:right;"> 0.6593 </td>
   <td style="text-align:right;"> 0.6471 </td>
   <td style="text-align:right;"> 3.5520 </td>
   <td style="text-align:right;"> 5.7004 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -2.7291 </td>
   <td style="text-align:right;"> -2.7330 </td>
   <td style="text-align:right;"> 0.4134 </td>
   <td style="text-align:right;"> 0.4121 </td>
   <td style="text-align:right;"> -3.4176 </td>
   <td style="text-align:right;"> -2.0493 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -1.3177 </td>
   <td style="text-align:right;"> -1.3113 </td>
   <td style="text-align:right;"> 0.2343 </td>
   <td style="text-align:right;"> 0.2286 </td>
   <td style="text-align:right;"> -1.7208 </td>
   <td style="text-align:right;"> -0.9434 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> -6.8893 </td>
   <td style="text-align:right;"> -6.8756 </td>
   <td style="text-align:right;"> 0.5155 </td>
   <td style="text-align:right;"> 0.5217 </td>
   <td style="text-align:right;"> -7.7422 </td>
   <td style="text-align:right;"> -6.0382 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.7486 </td>
   <td style="text-align:right;"> -0.7458 </td>
   <td style="text-align:right;"> 0.2701 </td>
   <td style="text-align:right;"> 0.2714 </td>
   <td style="text-align:right;"> -1.1979 </td>
   <td style="text-align:right;"> -0.3040 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> 4.0763 </td>
   <td style="text-align:right;"> 4.0785 </td>
   <td style="text-align:right;"> 0.3696 </td>
   <td style="text-align:right;"> 0.3672 </td>
   <td style="text-align:right;"> 3.4743 </td>
   <td style="text-align:right;"> 4.6866 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-48_657ae30470af4ed463981951b88f9cf2">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-49_4f204b9b251accf0f3f8f97244cbb72f">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-50_4737fdfcf10dca65dd95ee37b7af34fb">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(dataBino<span class="sc">$</span>nPobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="regresión-multinomial-con-vínculo-logit" class="level2">
<h2 class="anchored" data-anchor-id="regresión-multinomial-con-vínculo-logit">Regresión multinomial con vínculo logit</h2>
<p>La distribución multinomial es una extensión de la distribución binomial, esta se aplica en situaciones donde hay un número fijo de ensayos independientes, donde cada el resultado de cada ensayo corresponde a una de <span class="math inline">\(K\)</span> categorías.</p>
<p>Generalizando lo anterior, se considera <span class="math inline">\(\mathbf{Y}=\{\mathbf{Y}_1, \ldots, \mathbf{Y}_n\}\)</span> un conjunto de vectores aleatorios intercambiables cada una con distribución multinomial de parámetros <span class="math inline">\((n_i, \boldsymbol{\theta}_i)\)</span>. Note que todos lo vectores tienen <span class="math inline">\(K\)</span> categorias; en particular, el <span class="math inline">\(i\)</span>-ésimo vector del conjunto se define como <span class="math inline">\(\mathbf{Y}_i=(Y_{i1}, \ldots, Y_{iK})'\)</span>, el vector de parámetros de interés es <span class="math inline">\(\boldsymbol{\theta}_i=(\theta_{i1},\ldots, \theta_{iK})\)</span> con <span class="math inline">\(\sum_{k=1}^K\theta_{ik}=1\)</span>, y <span class="math inline">\(n_i=\sum_{k=1}^K Y_{ik}\)</span>, y por ende se tiene que la distribución, condicional a <span class="math inline">\(n_i\)</span>, de <span class="math inline">\(\mathbf{Y}_{i}\)</span> sigue una distribución multinomial tal que:</p>
<p><span class="math display">\[
\begin{equation}
p(\mathbf{Y}_{i}\mid n_i, \boldsymbol{\theta}_i)=\binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}
\end{equation}
\]</span></p>
<p>Con base en lo anterior, la verosimilitud de los datos se tiene mediante la siguiente expresión</p>
<p><span class="math display">\[
\begin{equation}
p(\mathbf{Y} \mid n, \boldsymbol{\theta})=\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}
\end{equation}
\]</span></p>
<p>Antes de proseguir con el modelamiento bayesiano, es útil notar que en este caso el vínculo no es un vector sino una matriz que responde a una relación lineal entre las covariables y una matriz de coeficientes de regresión, como se puede ver a continuación.</p>
<p><span class="math display">\[
\begin{equation*}
\begin{bmatrix}
  \eta_{11} &amp; \eta_{12} &amp; \cdots &amp; \eta_{1K} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \eta_{n1} &amp; \eta_{n2} &amp; \cdots &amp; \eta_{nK}
\end{bmatrix}
=
\begin{bmatrix}
  X_{11} &amp; X_{12} &amp; \cdots &amp; X_{1q} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  X_{n1} &amp; X_{n2} &amp; \cdots &amp; X_{nq}
\end{bmatrix}
\begin{bmatrix}
  \beta_{11} &amp; \beta_{12} &amp; \cdots &amp; \beta_{1K} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \beta_{q1} &amp; \beta_{q2} &amp; \cdots &amp; \beta_{qK}
\end{bmatrix}
\end{equation*}
\]</span></p>
<p>Es decir,</p>
<p><span class="math display">\[
\begin{equation}
\boldsymbol{\eta}=\mathbf{X}'\boldsymbol{\beta}
\end{equation}
\]</span></p>
<p>Lo anterior conlleva a que <span class="math inline">\(\eta_{ik}=\mathbf{X}_i'\boldsymbol{\beta}_k\)</span>, donde <span class="math inline">\(\mathbf{X}_i\)</span> es la <span class="math inline">\(i\)</span>-ésima fila de la matriz <span class="math inline">\(\mathbf{X}\)</span> y <span class="math inline">\(\boldsymbol{\beta}_k\)</span> es la <span class="math inline">\(k\)</span>-ésima columna de la matriz <span class="math inline">\(\boldsymbol{\beta}\)</span>. Ahora, tomando como línea de base la primera columna de la matriz <span class="math inline">\(\boldsymbol{\eta}\)</span> (es decir, el vector de las probabilidades de la categoría 1 para los <span class="math inline">\(n\)</span> individuos), y utilizando la función de vinculo logístico, se tiene que para los elementos en las restantes columnas de <span class="math inline">\(\boldsymbol{\eta}\)</span>,</p>
<p><span class="math display">\[
\begin{equation}
\eta_{ik}=g(\theta_{ik})=\log\left(\frac{\theta_{ik}}{\theta_{i1}}\right)=\log\left(\frac{\theta_{ik}}{\theta_{i1}}\right)
\end{equation}
\]</span> Con un poco de álgebra se comprueba que la función inversa para <span class="math inline">\(g(\cdot)\)</span> está dada por la siguiente expresión</p>
<p><span class="math display">\[
\begin{equation}
\theta_{ik}=g^{-1}(\eta_{ik})=\theta_{i1}\exp(\eta_{ik}) \ \ \ \ \ \forall k=2,\ldots,K
\end{equation}
\]</span></p>
<p>Ahora, para la primera columna de <span class="math inline">\(\boldsymbol{\eta}\)</span>, es decir, el vector de probabilidades de la primera categoría, se tiene que</p>
<p><span class="math display">\[
\begin{equation*}
\theta_{i1}=1-\sum_{j=2}^K\theta_{ij}=1-\sum_{j=2}^K\theta_{i1}\exp(\eta_{ij})
\end{equation*}
\]</span></p>
<p>de donde se tiene que</p>
<p><span class="math display">\[
\begin{equation}
\theta_{i1}=\frac{1}{1+\sum_{j=2}^K\exp(\eta_{ij})}
\end{equation}
\]</span></p>
<p>Finalmente, se tiene que <span class="math display">\[
\begin{equation*}
\theta_{ik}=\frac{\exp(\eta_{ik})}{1+\sum_{k=2}^K\exp(\eta_{ik})} \ \ \ \ \forall k=1,\ldots,K
\end{equation*}
\]</span></p>
<p>con <span class="math inline">\(\boldsymbol{\beta}_1=0\)</span>, esto es <span class="math inline">\(\eta_{i1}=0\)</span> para todo <span class="math inline">\(i\)</span>. Notando que <span class="math inline">\(\eta_{ik}=\mathbf{X}_i'\boldsymbol{\beta}_k\)</span>, se tiene que la verosimilitud de los datos toma la siguiente forma</p>
<p><span class="math display">\[
\begin{align*}
p(\mathbf{Y} \mid n, \boldsymbol{\theta})=&amp;\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}\\
p(\mathbf{Y} \mid n, \boldsymbol{\beta})=&amp;\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}
\prod_{k=1}^K\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}{1+\sum_{k=2}^K\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}\right)^{y_{ik}}\\
\end{align*}
\]</span></p>
<p>Suponiendo que la distribución a priori para <span class="math inline">\(\boldsymbol{\beta}_k\)</span> está regida por la siguiente estructura probabilística <span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}_k\sim N_q(\mathbf{b}_k,\mathbf{B}_k)
\end{equation*}
\]</span></p>
<p>De esta manera, la distribución a posteriori para el <span class="math inline">\(k\)</span> ésimo vector <span class="math inline">\(\boldsymbol{\beta}_k\)</span> toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta}_k \mid \mathbf{Y}, \mathbf{X}, n)&amp;\propto
\prod_{i=1}^n \left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}{1+\sum_{k=2}^K\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}\right)^{y_{ik}}\\
&amp;\hspace{2cm}\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>Una vez más, la anterior expresión no tiene una forma cerrada.</p>
<section id="práctica-en-stan-2" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-2">Práctica en <code>STAN</code></h3>
<p>Datos de la encuesta</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-51_31387a94cd8f5c4e603c98358202de56">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dataMultinomial <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;=</span> <span class="dv">18</span>, condact3 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>   depto,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">empleo =</span> <span class="fu">as_factor</span>(condact3),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(depto, empleo) <span class="sc">%&gt;%</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>dataMultinomial <span class="ot">&lt;-</span> dataMultinomial <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> <span class="st">"empleo"</span>,<span class="at">value =</span> <span class="st">"n"</span>, <span class="at">fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">inner_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"depto"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(dataMultinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> depto </th>
   <th style="text-align:right;"> Ocupado </th>
   <th style="text-align:right;"> Desocupado </th>
   <th style="text-align:right;"> Inactivo </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivo </th>
   <th style="text-align:right;"> suelo_urbano </th>
   <th style="text-align:right;"> modificacion_humana </th>
   <th style="text-align:right;"> tiempo_hospital </th>
   <th style="text-align:right;"> tiempo_hospital_caminando </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> discapacidad1 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 2222 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 414 </td>
   <td style="text-align:right;"> 41.76282 </td>
   <td style="text-align:right;"> 43.48416 </td>
   <td style="text-align:right;"> 43.57739 </td>
   <td style="text-align:right;"> 46.97255 </td>
   <td style="text-align:right;"> 48.64957 </td>
   <td style="text-align:right;"> 48.29499 </td>
   <td style="text-align:right;"> 0.4935 </td>
   <td style="text-align:right;"> 0.4934 </td>
   <td style="text-align:right;"> 0.2356 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.1665 </td>
   <td style="text-align:right;"> 0.0709 </td>
   <td style="text-align:right;"> 0.0246 </td>
   <td style="text-align:right;"> 0.0876 </td>
   <td style="text-align:right;"> 0.3958 </td>
   <td style="text-align:right;"> 0.2696 </td>
   <td style="text-align:right;"> 0.1188 </td>
   <td style="text-align:right;"> 0.1205 </td>
   <td style="text-align:right;"> 0.6632 </td>
   <td style="text-align:right;"> 0.4585 </td>
   <td style="text-align:right;"> 0.4646 </td>
   <td style="text-align:right;"> 0.5092 </td>
   <td style="text-align:right;"> 0.9557 </td>
   <td style="text-align:right;"> 0.4561 </td>
   <td style="text-align:right;"> 0.8770 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.1621 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 2370 </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> 734 </td>
   <td style="text-align:right;"> 51.61811 </td>
   <td style="text-align:right;"> 51.73498 </td>
   <td style="text-align:right;"> 52.22498 </td>
   <td style="text-align:right;"> 52.46159 </td>
   <td style="text-align:right;"> 46.91322 </td>
   <td style="text-align:right;"> 46.96396 </td>
   <td style="text-align:right;"> 0.7076 </td>
   <td style="text-align:right;"> 0.5038 </td>
   <td style="text-align:right;"> 0.2358 </td>
   <td style="text-align:right;"> 0.2060 </td>
   <td style="text-align:right;"> 0.1898 </td>
   <td style="text-align:right;"> 0.0984 </td>
   <td style="text-align:right;"> 0.0245 </td>
   <td style="text-align:right;"> 0.1134 </td>
   <td style="text-align:right;"> 0.2831 </td>
   <td style="text-align:right;"> 0.3200 </td>
   <td style="text-align:right;"> 0.2018 </td>
   <td style="text-align:right;"> 0.2715 </td>
   <td style="text-align:right;"> 0.5615 </td>
   <td style="text-align:right;"> 0.3902 </td>
   <td style="text-align:right;"> 0.4254 </td>
   <td style="text-align:right;"> 0.4013 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.3548 </td>
   <td style="text-align:right;"> 0.7195 </td>
   <td style="text-align:right;"> 0.3978 </td>
   <td style="text-align:right;"> 0.2530 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.0021 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 1699 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 237 </td>
   <td style="text-align:right;"> 44.50173 </td>
   <td style="text-align:right;"> 50.32670 </td>
   <td style="text-align:right;"> 47.42621 </td>
   <td style="text-align:right;"> 46.64527 </td>
   <td style="text-align:right;"> 46.80769 </td>
   <td style="text-align:right;"> 46.90296 </td>
   <td style="text-align:right;"> 0.5736 </td>
   <td style="text-align:right;"> 0.5019 </td>
   <td style="text-align:right;"> 0.2427 </td>
   <td style="text-align:right;"> 0.1974 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.0936 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 0.1078 </td>
   <td style="text-align:right;"> 0.2814 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.1768 </td>
   <td style="text-align:right;"> 0.6764 </td>
   <td style="text-align:right;"> 0.6685 </td>
   <td style="text-align:right;"> 0.4673 </td>
   <td style="text-align:right;"> 0.4394 </td>
   <td style="text-align:right;"> 0.5544 </td>
   <td style="text-align:right;"> 0.9112 </td>
   <td style="text-align:right;"> 0.4614 </td>
   <td style="text-align:right;"> 0.8614 </td>
   <td style="text-align:right;"> 0.3859 </td>
   <td style="text-align:right;"> 0.2267 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 2406 </td>
   <td style="text-align:right;"> 131 </td>
   <td style="text-align:right;"> 906 </td>
   <td style="text-align:right;"> 59.90582 </td>
   <td style="text-align:right;"> 49.27408 </td>
   <td style="text-align:right;"> 57.20224 </td>
   <td style="text-align:right;"> 53.91574 </td>
   <td style="text-align:right;"> 47.41502 </td>
   <td style="text-align:right;"> 48.26891 </td>
   <td style="text-align:right;"> 0.9475 </td>
   <td style="text-align:right;"> 0.5062 </td>
   <td style="text-align:right;"> 0.2555 </td>
   <td style="text-align:right;"> 0.2263 </td>
   <td style="text-align:right;"> 0.1951 </td>
   <td style="text-align:right;"> 0.0862 </td>
   <td style="text-align:right;"> 0.0176 </td>
   <td style="text-align:right;"> 0.1089 </td>
   <td style="text-align:right;"> 0.1919 </td>
   <td style="text-align:right;"> 0.3300 </td>
   <td style="text-align:right;"> 0.3409 </td>
   <td style="text-align:right;"> 0.2828 </td>
   <td style="text-align:right;"> 0.5233 </td>
   <td style="text-align:right;"> 0.3959 </td>
   <td style="text-align:right;"> 0.4762 </td>
   <td style="text-align:right;"> 0.1053 </td>
   <td style="text-align:right;"> 0.6730 </td>
   <td style="text-align:right;"> 0.1097 </td>
   <td style="text-align:right;"> 0.4504 </td>
   <td style="text-align:right;"> 0.3622 </td>
   <td style="text-align:right;"> 0.4055 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.0031 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 1769 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 451 </td>
   <td style="text-align:right;"> 45.89331 </td>
   <td style="text-align:right;"> 56.07571 </td>
   <td style="text-align:right;"> 51.20286 </td>
   <td style="text-align:right;"> 54.72841 </td>
   <td style="text-align:right;"> 46.98491 </td>
   <td style="text-align:right;"> 47.21079 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.5022 </td>
   <td style="text-align:right;"> 0.2572 </td>
   <td style="text-align:right;"> 0.2016 </td>
   <td style="text-align:right;"> 0.1690 </td>
   <td style="text-align:right;"> 0.0867 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.1031 </td>
   <td style="text-align:right;"> 0.2907 </td>
   <td style="text-align:right;"> 0.3176 </td>
   <td style="text-align:right;"> 0.1788 </td>
   <td style="text-align:right;"> 0.6347 </td>
   <td style="text-align:right;"> 0.6610 </td>
   <td style="text-align:right;"> 0.4961 </td>
   <td style="text-align:right;"> 0.4794 </td>
   <td style="text-align:right;"> 0.4565 </td>
   <td style="text-align:right;"> 0.8963 </td>
   <td style="text-align:right;"> 0.3885 </td>
   <td style="text-align:right;"> 0.8350 </td>
   <td style="text-align:right;"> 0.4089 </td>
   <td style="text-align:right;"> 0.2332 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 2370 </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 503 </td>
   <td style="text-align:right;"> 49.07049 </td>
   <td style="text-align:right;"> 59.98774 </td>
   <td style="text-align:right;"> 49.65565 </td>
   <td style="text-align:right;"> 60.15467 </td>
   <td style="text-align:right;"> 47.03441 </td>
   <td style="text-align:right;"> 46.95647 </td>
   <td style="text-align:right;"> 0.3973 </td>
   <td style="text-align:right;"> 0.5059 </td>
   <td style="text-align:right;"> 0.2341 </td>
   <td style="text-align:right;"> 0.2086 </td>
   <td style="text-align:right;"> 0.1755 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.0447 </td>
   <td style="text-align:right;"> 0.0838 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2494 </td>
   <td style="text-align:right;"> 0.1299 </td>
   <td style="text-align:right;"> 0.0501 </td>
   <td style="text-align:right;"> 0.7166 </td>
   <td style="text-align:right;"> 0.3984 </td>
   <td style="text-align:right;"> 0.4466 </td>
   <td style="text-align:right;"> 0.5917 </td>
   <td style="text-align:right;"> 0.9074 </td>
   <td style="text-align:right;"> 0.4849 </td>
   <td style="text-align:right;"> 0.8342 </td>
   <td style="text-align:right;"> 0.2641 </td>
   <td style="text-align:right;"> 0.1689 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.0019 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 1480 </td>
   <td style="text-align:right;"> 137 </td>
   <td style="text-align:right;"> 791 </td>
   <td style="text-align:right;"> 43.14251 </td>
   <td style="text-align:right;"> 39.11361 </td>
   <td style="text-align:right;"> 44.11616 </td>
   <td style="text-align:right;"> 33.01350 </td>
   <td style="text-align:right;"> 46.65175 </td>
   <td style="text-align:right;"> 46.49964 </td>
   <td style="text-align:right;"> 1.0000 </td>
   <td style="text-align:right;"> 0.5082 </td>
   <td style="text-align:right;"> 0.2514 </td>
   <td style="text-align:right;"> 0.2260 </td>
   <td style="text-align:right;"> 0.1947 </td>
   <td style="text-align:right;"> 0.0831 </td>
   <td style="text-align:right;"> 0.0385 </td>
   <td style="text-align:right;"> 0.1096 </td>
   <td style="text-align:right;"> 0.1802 </td>
   <td style="text-align:right;"> 0.3999 </td>
   <td style="text-align:right;"> 0.2936 </td>
   <td style="text-align:right;"> 0.0891 </td>
   <td style="text-align:right;"> 0.2251 </td>
   <td style="text-align:right;"> 0.1480 </td>
   <td style="text-align:right;"> 0.2344 </td>
   <td style="text-align:right;"> 0.1327 </td>
   <td style="text-align:right;"> 0.5588 </td>
   <td style="text-align:right;"> 0.0494 </td>
   <td style="text-align:right;"> 0.3474 </td>
   <td style="text-align:right;"> 0.1623 </td>
   <td style="text-align:right;"> 0.3348 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.0022 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 2150 </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 459 </td>
   <td style="text-align:right;"> 52.56436 </td>
   <td style="text-align:right;"> 62.71131 </td>
   <td style="text-align:right;"> 60.31193 </td>
   <td style="text-align:right;"> 66.57010 </td>
   <td style="text-align:right;"> 48.93218 </td>
   <td style="text-align:right;"> 48.67928 </td>
   <td style="text-align:right;"> 0.6583 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.2583 </td>
   <td style="text-align:right;"> 0.2098 </td>
   <td style="text-align:right;"> 0.1828 </td>
   <td style="text-align:right;"> 0.0769 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 0.1099 </td>
   <td style="text-align:right;"> 0.2629 </td>
   <td style="text-align:right;"> 0.3185 </td>
   <td style="text-align:right;"> 0.2247 </td>
   <td style="text-align:right;"> 0.6015 </td>
   <td style="text-align:right;"> 0.5666 </td>
   <td style="text-align:right;"> 0.4046 </td>
   <td style="text-align:right;"> 0.4238 </td>
   <td style="text-align:right;"> 0.3837 </td>
   <td style="text-align:right;"> 0.8317 </td>
   <td style="text-align:right;"> 0.3994 </td>
   <td style="text-align:right;"> 0.8193 </td>
   <td style="text-align:right;"> 0.3390 </td>
   <td style="text-align:right;"> 0.2841 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.0030 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 1838 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 188 </td>
   <td style="text-align:right;"> 43.03490 </td>
   <td style="text-align:right;"> 50.59430 </td>
   <td style="text-align:right;"> 46.46389 </td>
   <td style="text-align:right;"> 45.49424 </td>
   <td style="text-align:right;"> 46.81505 </td>
   <td style="text-align:right;"> 46.97287 </td>
   <td style="text-align:right;"> 0.4524 </td>
   <td style="text-align:right;"> 0.5106 </td>
   <td style="text-align:right;"> 0.2438 </td>
   <td style="text-align:right;"> 0.1815 </td>
   <td style="text-align:right;"> 0.1762 </td>
   <td style="text-align:right;"> 0.0950 </td>
   <td style="text-align:right;"> 0.0006 </td>
   <td style="text-align:right;"> 0.0957 </td>
   <td style="text-align:right;"> 0.3205 </td>
   <td style="text-align:right;"> 0.3030 </td>
   <td style="text-align:right;"> 0.1303 </td>
   <td style="text-align:right;"> 0.6221 </td>
   <td style="text-align:right;"> 0.7762 </td>
   <td style="text-align:right;"> 0.5457 </td>
   <td style="text-align:right;"> 0.5703 </td>
   <td style="text-align:right;"> 0.6550 </td>
   <td style="text-align:right;"> 0.9509 </td>
   <td style="text-align:right;"> 0.4499 </td>
   <td style="text-align:right;"> 0.9256 </td>
   <td style="text-align:right;"> 0.4459 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.0006 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 2038 </td>
   <td style="text-align:right;"> 42 </td>
   <td style="text-align:right;"> 514 </td>
   <td style="text-align:right;"> 43.40122 </td>
   <td style="text-align:right;"> 49.46332 </td>
   <td style="text-align:right;"> 44.96708 </td>
   <td style="text-align:right;"> 51.97994 </td>
   <td style="text-align:right;"> 47.62130 </td>
   <td style="text-align:right;"> 47.50204 </td>
   <td style="text-align:right;"> 0.5890 </td>
   <td style="text-align:right;"> 0.5016 </td>
   <td style="text-align:right;"> 0.2549 </td>
   <td style="text-align:right;"> 0.1987 </td>
   <td style="text-align:right;"> 0.1696 </td>
   <td style="text-align:right;"> 0.0746 </td>
   <td style="text-align:right;"> 0.0174 </td>
   <td style="text-align:right;"> 0.0933 </td>
   <td style="text-align:right;"> 0.3327 </td>
   <td style="text-align:right;"> 0.2876 </td>
   <td style="text-align:right;"> 0.1622 </td>
   <td style="text-align:right;"> 0.3336 </td>
   <td style="text-align:right;"> 0.6983 </td>
   <td style="text-align:right;"> 0.4822 </td>
   <td style="text-align:right;"> 0.5781 </td>
   <td style="text-align:right;"> 0.5009 </td>
   <td style="text-align:right;"> 0.8919 </td>
   <td style="text-align:right;"> 0.3942 </td>
   <td style="text-align:right;"> 0.7909 </td>
   <td style="text-align:right;"> 0.3321 </td>
   <td style="text-align:right;"> 0.2194 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.0012 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 2271 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 1021 </td>
   <td style="text-align:right;"> 54.93899 </td>
   <td style="text-align:right;"> 44.90647 </td>
   <td style="text-align:right;"> 47.64537 </td>
   <td style="text-align:right;"> 41.31718 </td>
   <td style="text-align:right;"> 46.83591 </td>
   <td style="text-align:right;"> 46.83862 </td>
   <td style="text-align:right;"> 0.9305 </td>
   <td style="text-align:right;"> 0.5040 </td>
   <td style="text-align:right;"> 0.2517 </td>
   <td style="text-align:right;"> 0.2148 </td>
   <td style="text-align:right;"> 0.1807 </td>
   <td style="text-align:right;"> 0.0804 </td>
   <td style="text-align:right;"> 0.0392 </td>
   <td style="text-align:right;"> 0.1049 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.3635 </td>
   <td style="text-align:right;"> 0.2882 </td>
   <td style="text-align:right;"> 0.1156 </td>
   <td style="text-align:right;"> 0.4299 </td>
   <td style="text-align:right;"> 0.3302 </td>
   <td style="text-align:right;"> 0.3792 </td>
   <td style="text-align:right;"> 0.2521 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.1514 </td>
   <td style="text-align:right;"> 0.4882 </td>
   <td style="text-align:right;"> 0.5310 </td>
   <td style="text-align:right;"> 0.3519 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.0015 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:right;"> 2435 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 702 </td>
   <td style="text-align:right;"> 52.96135 </td>
   <td style="text-align:right;"> 52.47819 </td>
   <td style="text-align:right;"> 52.79902 </td>
   <td style="text-align:right;"> 55.94507 </td>
   <td style="text-align:right;"> 47.86821 </td>
   <td style="text-align:right;"> 47.83905 </td>
   <td style="text-align:right;"> 0.7541 </td>
   <td style="text-align:right;"> 0.5077 </td>
   <td style="text-align:right;"> 0.2588 </td>
   <td style="text-align:right;"> 0.2060 </td>
   <td style="text-align:right;"> 0.1755 </td>
   <td style="text-align:right;"> 0.0782 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.1024 </td>
   <td style="text-align:right;"> 0.2652 </td>
   <td style="text-align:right;"> 0.3378 </td>
   <td style="text-align:right;"> 0.2249 </td>
   <td style="text-align:right;"> 0.3079 </td>
   <td style="text-align:right;"> 0.5502 </td>
   <td style="text-align:right;"> 0.3712 </td>
   <td style="text-align:right;"> 0.4181 </td>
   <td style="text-align:right;"> 0.3128 </td>
   <td style="text-align:right;"> 0.8369 </td>
   <td style="text-align:right;"> 0.2871 </td>
   <td style="text-align:right;"> 0.6344 </td>
   <td style="text-align:right;"> 0.3066 </td>
   <td style="text-align:right;"> 0.2859 </td>
   <td style="text-align:right;"> 0.0672 </td>
   <td style="text-align:right;"> 0.0020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:right;"> 2417 </td>
   <td style="text-align:right;"> 122 </td>
   <td style="text-align:right;"> 1018 </td>
   <td style="text-align:right;"> 56.81108 </td>
   <td style="text-align:right;"> 57.11196 </td>
   <td style="text-align:right;"> 52.91757 </td>
   <td style="text-align:right;"> 50.00971 </td>
   <td style="text-align:right;"> 46.87770 </td>
   <td style="text-align:right;"> 46.81435 </td>
   <td style="text-align:right;"> 0.8028 </td>
   <td style="text-align:right;"> 0.5088 </td>
   <td style="text-align:right;"> 0.2523 </td>
   <td style="text-align:right;"> 0.2046 </td>
   <td style="text-align:right;"> 0.1801 </td>
   <td style="text-align:right;"> 0.0832 </td>
   <td style="text-align:right;"> 0.0574 </td>
   <td style="text-align:right;"> 0.0887 </td>
   <td style="text-align:right;"> 0.2974 </td>
   <td style="text-align:right;"> 0.3031 </td>
   <td style="text-align:right;"> 0.2204 </td>
   <td style="text-align:right;"> 0.0248 </td>
   <td style="text-align:right;"> 0.4550 </td>
   <td style="text-align:right;"> 0.2852 </td>
   <td style="text-align:right;"> 0.3418 </td>
   <td style="text-align:right;"> 0.2660 </td>
   <td style="text-align:right;"> 0.7279 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.6297 </td>
   <td style="text-align:right;"> 0.2918 </td>
   <td style="text-align:right;"> 0.2819 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.0025 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 2385 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 1062 </td>
   <td style="text-align:right;"> 50.34167 </td>
   <td style="text-align:right;"> 59.80458 </td>
   <td style="text-align:right;"> 46.11687 </td>
   <td style="text-align:right;"> 40.98730 </td>
   <td style="text-align:right;"> 46.76030 </td>
   <td style="text-align:right;"> 46.69590 </td>
   <td style="text-align:right;"> 0.8086 </td>
   <td style="text-align:right;"> 0.5124 </td>
   <td style="text-align:right;"> 0.2488 </td>
   <td style="text-align:right;"> 0.2012 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.0861 </td>
   <td style="text-align:right;"> 0.0658 </td>
   <td style="text-align:right;"> 0.0994 </td>
   <td style="text-align:right;"> 0.2665 </td>
   <td style="text-align:right;"> 0.3369 </td>
   <td style="text-align:right;"> 0.2291 </td>
   <td style="text-align:right;"> 0.0378 </td>
   <td style="text-align:right;"> 0.4177 </td>
   <td style="text-align:right;"> 0.2505 </td>
   <td style="text-align:right;"> 0.3281 </td>
   <td style="text-align:right;"> 0.1829 </td>
   <td style="text-align:right;"> 0.7133 </td>
   <td style="text-align:right;"> 0.2459 </td>
   <td style="text-align:right;"> 0.5532 </td>
   <td style="text-align:right;"> 0.2519 </td>
   <td style="text-align:right;"> 0.2836 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.0020 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 6928 </td>
   <td style="text-align:right;"> 549 </td>
   <td style="text-align:right;"> 3498 </td>
   <td style="text-align:right;"> 89.30660 </td>
   <td style="text-align:right;"> 49.30061 </td>
   <td style="text-align:right;"> 91.84659 </td>
   <td style="text-align:right;"> 52.19096 </td>
   <td style="text-align:right;"> 46.91756 </td>
   <td style="text-align:right;"> 46.96556 </td>
   <td style="text-align:right;"> 0.9879 </td>
   <td style="text-align:right;"> 0.5088 </td>
   <td style="text-align:right;"> 0.2591 </td>
   <td style="text-align:right;"> 0.2319 </td>
   <td style="text-align:right;"> 0.1973 </td>
   <td style="text-align:right;"> 0.0867 </td>
   <td style="text-align:right;"> 0.0233 </td>
   <td style="text-align:right;"> 0.1095 </td>
   <td style="text-align:right;"> 0.1742 </td>
   <td style="text-align:right;"> 0.3731 </td>
   <td style="text-align:right;"> 0.3334 </td>
   <td style="text-align:right;"> 0.1420 </td>
   <td style="text-align:right;"> 0.2911 </td>
   <td style="text-align:right;"> 0.2261 </td>
   <td style="text-align:right;"> 0.2895 </td>
   <td style="text-align:right;"> 0.2151 </td>
   <td style="text-align:right;"> 0.5290 </td>
   <td style="text-align:right;"> 0.0653 </td>
   <td style="text-align:right;"> 0.3305 </td>
   <td style="text-align:right;"> 0.2364 </td>
   <td style="text-align:right;"> 0.3871 </td>
   <td style="text-align:right;"> 0.0190 </td>
   <td style="text-align:right;"> 0.0181 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:right;"> 2448 </td>
   <td style="text-align:right;"> 43 </td>
   <td style="text-align:right;"> 879 </td>
   <td style="text-align:right;"> 46.00443 </td>
   <td style="text-align:right;"> 39.68968 </td>
   <td style="text-align:right;"> 44.96969 </td>
   <td style="text-align:right;"> 68.41467 </td>
   <td style="text-align:right;"> 96.38752 </td>
   <td style="text-align:right;"> 96.31929 </td>
   <td style="text-align:right;"> 0.7079 </td>
   <td style="text-align:right;"> 0.4946 </td>
   <td style="text-align:right;"> 0.2312 </td>
   <td style="text-align:right;"> 0.1890 </td>
   <td style="text-align:right;"> 0.1524 </td>
   <td style="text-align:right;"> 0.0576 </td>
   <td style="text-align:right;"> 0.0191 </td>
   <td style="text-align:right;"> 0.0787 </td>
   <td style="text-align:right;"> 0.3507 </td>
   <td style="text-align:right;"> 0.3107 </td>
   <td style="text-align:right;"> 0.1405 </td>
   <td style="text-align:right;"> 0.0817 </td>
   <td style="text-align:right;"> 0.6410 </td>
   <td style="text-align:right;"> 0.3610 </td>
   <td style="text-align:right;"> 0.5728 </td>
   <td style="text-align:right;"> 0.5076 </td>
   <td style="text-align:right;"> 0.8734 </td>
   <td style="text-align:right;"> 0.2065 </td>
   <td style="text-align:right;"> 0.6946 </td>
   <td style="text-align:right;"> 0.2949 </td>
   <td style="text-align:right;"> 0.2046 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.0016 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 17 </td>
   <td style="text-align:right;"> 998 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 221 </td>
   <td style="text-align:right;"> 42.64701 </td>
   <td style="text-align:right;"> 40.03863 </td>
   <td style="text-align:right;"> 42.34770 </td>
   <td style="text-align:right;"> 43.67581 </td>
   <td style="text-align:right;"> 53.92583 </td>
   <td style="text-align:right;"> 54.30864 </td>
   <td style="text-align:right;"> 0.8556 </td>
   <td style="text-align:right;"> 0.4723 </td>
   <td style="text-align:right;"> 0.2646 </td>
   <td style="text-align:right;"> 0.2331 </td>
   <td style="text-align:right;"> 0.1571 </td>
   <td style="text-align:right;"> 0.0345 </td>
   <td style="text-align:right;"> 0.0198 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.2470 </td>
   <td style="text-align:right;"> 0.3732 </td>
   <td style="text-align:right;"> 0.2034 </td>
   <td style="text-align:right;"> 0.2998 </td>
   <td style="text-align:right;"> 0.6473 </td>
   <td style="text-align:right;"> 0.3646 </td>
   <td style="text-align:right;"> 0.4484 </td>
   <td style="text-align:right;"> 0.2611 </td>
   <td style="text-align:right;"> 0.8375 </td>
   <td style="text-align:right;"> 0.1241 </td>
   <td style="text-align:right;"> 0.5881 </td>
   <td style="text-align:right;"> 0.2721 </td>
   <td style="text-align:right;"> 0.2513 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 0.0003 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 18 </td>
   <td style="text-align:right;"> 1432 </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 510 </td>
   <td style="text-align:right;"> 45.38056 </td>
   <td style="text-align:right;"> 40.28007 </td>
   <td style="text-align:right;"> 43.33857 </td>
   <td style="text-align:right;"> 38.20989 </td>
   <td style="text-align:right;"> 46.85365 </td>
   <td style="text-align:right;"> 46.93853 </td>
   <td style="text-align:right;"> 0.9214 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.2311 </td>
   <td style="text-align:right;"> 0.2362 </td>
   <td style="text-align:right;"> 0.2082 </td>
   <td style="text-align:right;"> 0.0915 </td>
   <td style="text-align:right;"> 0.0213 </td>
   <td style="text-align:right;"> 0.1157 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.3215 </td>
   <td style="text-align:right;"> 0.3420 </td>
   <td style="text-align:right;"> 0.2996 </td>
   <td style="text-align:right;"> 0.4871 </td>
   <td style="text-align:right;"> 0.4154 </td>
   <td style="text-align:right;"> 0.4735 </td>
   <td style="text-align:right;"> 0.2147 </td>
   <td style="text-align:right;"> 0.7523 </td>
   <td style="text-align:right;"> 0.1941 </td>
   <td style="text-align:right;"> 0.5862 </td>
   <td style="text-align:right;"> 0.3724 </td>
   <td style="text-align:right;"> 0.3988 </td>
   <td style="text-align:right;"> 0.0380 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:right;"> 1462 </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 351 </td>
   <td style="text-align:right;"> 43.59944 </td>
   <td style="text-align:right;"> 46.15043 </td>
   <td style="text-align:right;"> 43.32514 </td>
   <td style="text-align:right;"> 43.92455 </td>
   <td style="text-align:right;"> 47.52889 </td>
   <td style="text-align:right;"> 47.24642 </td>
   <td style="text-align:right;"> 0.6777 </td>
   <td style="text-align:right;"> 0.4932 </td>
   <td style="text-align:right;"> 0.2606 </td>
   <td style="text-align:right;"> 0.2167 </td>
   <td style="text-align:right;"> 0.1715 </td>
   <td style="text-align:right;"> 0.0660 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.0972 </td>
   <td style="text-align:right;"> 0.2731 </td>
   <td style="text-align:right;"> 0.3399 </td>
   <td style="text-align:right;"> 0.2079 </td>
   <td style="text-align:right;"> 0.3443 </td>
   <td style="text-align:right;"> 0.6308 </td>
   <td style="text-align:right;"> 0.4806 </td>
   <td style="text-align:right;"> 0.5689 </td>
   <td style="text-align:right;"> 0.4056 </td>
   <td style="text-align:right;"> 0.9052 </td>
   <td style="text-align:right;"> 0.2189 </td>
   <td style="text-align:right;"> 0.7307 </td>
   <td style="text-align:right;"> 0.3766 </td>
   <td style="text-align:right;"> 0.2630 </td>
   <td style="text-align:right;"> 0.0740 </td>
   <td style="text-align:right;"> 0.0005 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 2887 </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 956 </td>
   <td style="text-align:right;"> 63.18305 </td>
   <td style="text-align:right;"> 65.08510 </td>
   <td style="text-align:right;"> 52.71714 </td>
   <td style="text-align:right;"> 54.97437 </td>
   <td style="text-align:right;"> 46.96204 </td>
   <td style="text-align:right;"> 46.97502 </td>
   <td style="text-align:right;"> 0.7956 </td>
   <td style="text-align:right;"> 0.5028 </td>
   <td style="text-align:right;"> 0.2417 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> 0.0747 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.0899 </td>
   <td style="text-align:right;"> 0.3118 </td>
   <td style="text-align:right;"> 0.3123 </td>
   <td style="text-align:right;"> 0.1881 </td>
   <td style="text-align:right;"> 0.0181 </td>
   <td style="text-align:right;"> 0.5524 </td>
   <td style="text-align:right;"> 0.2797 </td>
   <td style="text-align:right;"> 0.4113 </td>
   <td style="text-align:right;"> 0.3422 </td>
   <td style="text-align:right;"> 0.8252 </td>
   <td style="text-align:right;"> 0.4201 </td>
   <td style="text-align:right;"> 0.5998 </td>
   <td style="text-align:right;"> 0.1859 </td>
   <td style="text-align:right;"> 0.2370 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.0034 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 1927 </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 294 </td>
   <td style="text-align:right;"> 50.23697 </td>
   <td style="text-align:right;"> 79.48816 </td>
   <td style="text-align:right;"> 54.49696 </td>
   <td style="text-align:right;"> 72.45130 </td>
   <td style="text-align:right;"> 48.56200 </td>
   <td style="text-align:right;"> 48.87507 </td>
   <td style="text-align:right;"> 0.5822 </td>
   <td style="text-align:right;"> 0.5032 </td>
   <td style="text-align:right;"> 0.2606 </td>
   <td style="text-align:right;"> 0.2104 </td>
   <td style="text-align:right;"> 0.1864 </td>
   <td style="text-align:right;"> 0.0925 </td>
   <td style="text-align:right;"> 0.0004 </td>
   <td style="text-align:right;"> 0.1305 </td>
   <td style="text-align:right;"> 0.2769 </td>
   <td style="text-align:right;"> 0.3503 </td>
   <td style="text-align:right;"> 0.1892 </td>
   <td style="text-align:right;"> 0.7313 </td>
   <td style="text-align:right;"> 0.7726 </td>
   <td style="text-align:right;"> 0.5274 </td>
   <td style="text-align:right;"> 0.6993 </td>
   <td style="text-align:right;"> 0.4359 </td>
   <td style="text-align:right;"> 0.9257 </td>
   <td style="text-align:right;"> 0.4117 </td>
   <td style="text-align:right;"> 0.7998 </td>
   <td style="text-align:right;"> 0.4683 </td>
   <td style="text-align:right;"> 0.2281 </td>
   <td style="text-align:right;"> 0.1069 </td>
   <td style="text-align:right;"> 0.0043 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 22 </td>
   <td style="text-align:right;"> 2384 </td>
   <td style="text-align:right;"> 34 </td>
   <td style="text-align:right;"> 571 </td>
   <td style="text-align:right;"> 45.75484 </td>
   <td style="text-align:right;"> 40.80174 </td>
   <td style="text-align:right;"> 48.96197 </td>
   <td style="text-align:right;"> 53.50148 </td>
   <td style="text-align:right;"> 49.12672 </td>
   <td style="text-align:right;"> 48.39034 </td>
   <td style="text-align:right;"> 0.7116 </td>
   <td style="text-align:right;"> 0.4870 </td>
   <td style="text-align:right;"> 0.2437 </td>
   <td style="text-align:right;"> 0.2104 </td>
   <td style="text-align:right;"> 0.1711 </td>
   <td style="text-align:right;"> 0.0599 </td>
   <td style="text-align:right;"> 0.0354 </td>
   <td style="text-align:right;"> 0.0890 </td>
   <td style="text-align:right;"> 0.3782 </td>
   <td style="text-align:right;"> 0.2871 </td>
   <td style="text-align:right;"> 0.1418 </td>
   <td style="text-align:right;"> 0.0471 </td>
   <td style="text-align:right;"> 0.6316 </td>
   <td style="text-align:right;"> 0.2968 </td>
   <td style="text-align:right;"> 0.3764 </td>
   <td style="text-align:right;"> 0.3653 </td>
   <td style="text-align:right;"> 0.8555 </td>
   <td style="text-align:right;"> 0.3479 </td>
   <td style="text-align:right;"> 0.5983 </td>
   <td style="text-align:right;"> 0.2207 </td>
   <td style="text-align:right;"> 0.1825 </td>
   <td style="text-align:right;"> 0.0759 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 23 </td>
   <td style="text-align:right;"> 1966 </td>
   <td style="text-align:right;"> 107 </td>
   <td style="text-align:right;"> 781 </td>
   <td style="text-align:right;"> 46.03361 </td>
   <td style="text-align:right;"> 40.43865 </td>
   <td style="text-align:right;"> 45.17116 </td>
   <td style="text-align:right;"> 38.40902 </td>
   <td style="text-align:right;"> 46.81648 </td>
   <td style="text-align:right;"> 46.75680 </td>
   <td style="text-align:right;"> 0.9430 </td>
   <td style="text-align:right;"> 0.5006 </td>
   <td style="text-align:right;"> 0.2588 </td>
   <td style="text-align:right;"> 0.2416 </td>
   <td style="text-align:right;"> 0.1970 </td>
   <td style="text-align:right;"> 0.0708 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 0.1148 </td>
   <td style="text-align:right;"> 0.2007 </td>
   <td style="text-align:right;"> 0.3698 </td>
   <td style="text-align:right;"> 0.3014 </td>
   <td style="text-align:right;"> 0.3288 </td>
   <td style="text-align:right;"> 0.5167 </td>
   <td style="text-align:right;"> 0.4417 </td>
   <td style="text-align:right;"> 0.5037 </td>
   <td style="text-align:right;"> 0.1575 </td>
   <td style="text-align:right;"> 0.7088 </td>
   <td style="text-align:right;"> 0.1765 </td>
   <td style="text-align:right;"> 0.4758 </td>
   <td style="text-align:right;"> 0.3946 </td>
   <td style="text-align:right;"> 0.3608 </td>
   <td style="text-align:right;"> 0.0318 </td>
   <td style="text-align:right;"> 0.0008 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 24 </td>
   <td style="text-align:right;"> 1376 </td>
   <td style="text-align:right;"> 56 </td>
   <td style="text-align:right;"> 477 </td>
   <td style="text-align:right;"> 43.83846 </td>
   <td style="text-align:right;"> 41.56019 </td>
   <td style="text-align:right;"> 41.25498 </td>
   <td style="text-align:right;"> 35.27992 </td>
   <td style="text-align:right;"> 46.68707 </td>
   <td style="text-align:right;"> 46.56386 </td>
   <td style="text-align:right;"> 0.9358 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.2408 </td>
   <td style="text-align:right;"> 0.2171 </td>
   <td style="text-align:right;"> 0.1855 </td>
   <td style="text-align:right;"> 0.0631 </td>
   <td style="text-align:right;"> 0.0877 </td>
   <td style="text-align:right;"> 0.0946 </td>
   <td style="text-align:right;"> 0.2655 </td>
   <td style="text-align:right;"> 0.3530 </td>
   <td style="text-align:right;"> 0.2191 </td>
   <td style="text-align:right;"> 0.0162 </td>
   <td style="text-align:right;"> 0.4925 </td>
   <td style="text-align:right;"> 0.3218 </td>
   <td style="text-align:right;"> 0.4009 </td>
   <td style="text-align:right;"> 0.1241 </td>
   <td style="text-align:right;"> 0.7890 </td>
   <td style="text-align:right;"> 0.2265 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.2631 </td>
   <td style="text-align:right;"> 0.2719 </td>
   <td style="text-align:right;"> 0.0329 </td>
   <td style="text-align:right;"> 0.0004 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 25 </td>
   <td style="text-align:right;"> 1945 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 548 </td>
   <td style="text-align:right;"> 44.06669 </td>
   <td style="text-align:right;"> 40.09964 </td>
   <td style="text-align:right;"> 44.94290 </td>
   <td style="text-align:right;"> 48.77275 </td>
   <td style="text-align:right;"> 58.06502 </td>
   <td style="text-align:right;"> 58.22063 </td>
   <td style="text-align:right;"> 0.8102 </td>
   <td style="text-align:right;"> 0.4911 </td>
   <td style="text-align:right;"> 0.2463 </td>
   <td style="text-align:right;"> 0.2009 </td>
   <td style="text-align:right;"> 0.1548 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 0.0832 </td>
   <td style="text-align:right;"> 0.3013 </td>
   <td style="text-align:right;"> 0.3378 </td>
   <td style="text-align:right;"> 0.1656 </td>
   <td style="text-align:right;"> 0.1140 </td>
   <td style="text-align:right;"> 0.7084 </td>
   <td style="text-align:right;"> 0.3795 </td>
   <td style="text-align:right;"> 0.5214 </td>
   <td style="text-align:right;"> 0.2912 </td>
   <td style="text-align:right;"> 0.8442 </td>
   <td style="text-align:right;"> 0.2300 </td>
   <td style="text-align:right;"> 0.8038 </td>
   <td style="text-align:right;"> 0.3002 </td>
   <td style="text-align:right;"> 0.2207 </td>
   <td style="text-align:right;"> 0.0477 </td>
   <td style="text-align:right;"> 0.0010 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-52_f38f244bc58235db09f4c938471f85a1">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> D;    <span class="sc">/</span><span class="er">/</span> Número de dominios </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> P;    <span class="sc">/</span><span class="er">/</span> Categorías</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> K;    <span class="sc">/</span><span class="er">/</span> Número de regresores</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  int y[D, P];       <span class="sc">/</span><span class="er">/</span> Matriz de datos</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  matrix[D, K] X;    <span class="sc">/</span><span class="er">/</span> Matriz de covariables</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  matrix[P<span class="dv">-1</span>, K] beta;<span class="sc">/</span><span class="er">/</span> Matriz de parámetros </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  simplex[P] theta[D];<span class="sc">/</span><span class="er">/</span> Vector de parámetros;</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  real num[D, P];</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  real den[D];</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    num[d, <span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span>;</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    num[d, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">exp</span>(X[d, ] <span class="sc">*</span> beta[<span class="dv">1</span>, ]<span class="st">') ;</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="st">    num[d, 3] = exp(X[d, ] * beta[2, ]'</span>) ;</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    den[d] <span class="ot">=</span> <span class="fu">sum</span>(num[d, ]);</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(p <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>P){</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    theta[d, p] <span class="ot">=</span> num[d, p]<span class="sc">/</span>den[d];</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    theta[d, <span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>den[d];</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>);</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    target <span class="sc">+</span><span class="er">=</span> <span class="fu">multinomial_lpmf</span>(y[d, ] <span class="sc">|</span> theta[d, ]); </span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    int ypred[D,P];               </span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>    ypred[d,] <span class="ot">=</span> <span class="fu">multinomial_rng</span>(theta[d, ], <span class="fu">sum</span>(y[d, ])); </span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-53_76fcfadd3519b08ea19f912274939a2d">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/12ModeloMultinomial.stan")</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>fitMultinomial <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/12ModeloMultinomial.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-54_bee14ff402781211524dd81bd600469d">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  Ocupado <span class="sc">~</span> tasa_desocupacion <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    suelo_cultivo  <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    suelo_urbano <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    discapacidad1 <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    alfabeta <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    rezago_escolar  ,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dataMultinomial</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> suelo_cultivo </th>
   <th style="text-align:right;"> suelo_urbano </th>
   <th style="text-align:right;"> discapacidad1 </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> rezago_escolar </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0005 </td>
   <td style="text-align:right;"> 43.4842 </td>
   <td style="text-align:right;"> 43.5774 </td>
   <td style="text-align:right;"> 0.0876 </td>
   <td style="text-align:right;"> 0.1075 </td>
   <td style="text-align:right;"> 0.1621 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0021 </td>
   <td style="text-align:right;"> 51.7350 </td>
   <td style="text-align:right;"> 52.2250 </td>
   <td style="text-align:right;"> 0.1134 </td>
   <td style="text-align:right;"> 0.1066 </td>
   <td style="text-align:right;"> 0.2530 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0010 </td>
   <td style="text-align:right;"> 50.3267 </td>
   <td style="text-align:right;"> 47.4262 </td>
   <td style="text-align:right;"> 0.1078 </td>
   <td style="text-align:right;"> 0.1723 </td>
   <td style="text-align:right;"> 0.2267 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0031 </td>
   <td style="text-align:right;"> 49.2741 </td>
   <td style="text-align:right;"> 57.2022 </td>
   <td style="text-align:right;"> 0.1089 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 0.4055 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 56.0757 </td>
   <td style="text-align:right;"> 51.2029 </td>
   <td style="text-align:right;"> 0.1031 </td>
   <td style="text-align:right;"> 0.1380 </td>
   <td style="text-align:right;"> 0.2332 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 59.9877 </td>
   <td style="text-align:right;"> 49.6557 </td>
   <td style="text-align:right;"> 0.0838 </td>
   <td style="text-align:right;"> 0.1509 </td>
   <td style="text-align:right;"> 0.1689 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0022 </td>
   <td style="text-align:right;"> 39.1136 </td>
   <td style="text-align:right;"> 44.1162 </td>
   <td style="text-align:right;"> 0.1096 </td>
   <td style="text-align:right;"> 0.0157 </td>
   <td style="text-align:right;"> 0.3348 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0030 </td>
   <td style="text-align:right;"> 62.7113 </td>
   <td style="text-align:right;"> 60.3119 </td>
   <td style="text-align:right;"> 0.1099 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.2841 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0006 </td>
   <td style="text-align:right;"> 50.5943 </td>
   <td style="text-align:right;"> 46.4639 </td>
   <td style="text-align:right;"> 0.0957 </td>
   <td style="text-align:right;"> 0.1830 </td>
   <td style="text-align:right;"> 0.1742 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 49.4633 </td>
   <td style="text-align:right;"> 44.9671 </td>
   <td style="text-align:right;"> 0.0933 </td>
   <td style="text-align:right;"> 0.1309 </td>
   <td style="text-align:right;"> 0.2194 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0015 </td>
   <td style="text-align:right;"> 44.9065 </td>
   <td style="text-align:right;"> 47.6454 </td>
   <td style="text-align:right;"> 0.1049 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.3519 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 52.4782 </td>
   <td style="text-align:right;"> 52.7990 </td>
   <td style="text-align:right;"> 0.1024 </td>
   <td style="text-align:right;"> 0.0672 </td>
   <td style="text-align:right;"> 0.2859 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0025 </td>
   <td style="text-align:right;"> 57.1120 </td>
   <td style="text-align:right;"> 52.9176 </td>
   <td style="text-align:right;"> 0.0887 </td>
   <td style="text-align:right;"> 0.0673 </td>
   <td style="text-align:right;"> 0.2819 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 59.8046 </td>
   <td style="text-align:right;"> 46.1169 </td>
   <td style="text-align:right;"> 0.0994 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.2836 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0181 </td>
   <td style="text-align:right;"> 49.3006 </td>
   <td style="text-align:right;"> 91.8466 </td>
   <td style="text-align:right;"> 0.1095 </td>
   <td style="text-align:right;"> 0.0190 </td>
   <td style="text-align:right;"> 0.3871 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0016 </td>
   <td style="text-align:right;"> 39.6897 </td>
   <td style="text-align:right;"> 44.9697 </td>
   <td style="text-align:right;"> 0.0787 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.2046 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0003 </td>
   <td style="text-align:right;"> 40.0386 </td>
   <td style="text-align:right;"> 42.3477 </td>
   <td style="text-align:right;"> 0.0856 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 0.2513 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0005 </td>
   <td style="text-align:right;"> 40.2801 </td>
   <td style="text-align:right;"> 43.3386 </td>
   <td style="text-align:right;"> 0.1157 </td>
   <td style="text-align:right;"> 0.0380 </td>
   <td style="text-align:right;"> 0.3988 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0005 </td>
   <td style="text-align:right;"> 46.1504 </td>
   <td style="text-align:right;"> 43.3251 </td>
   <td style="text-align:right;"> 0.0972 </td>
   <td style="text-align:right;"> 0.0740 </td>
   <td style="text-align:right;"> 0.2630 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0034 </td>
   <td style="text-align:right;"> 65.0851 </td>
   <td style="text-align:right;"> 52.7171 </td>
   <td style="text-align:right;"> 0.0899 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.2370 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0043 </td>
   <td style="text-align:right;"> 79.4882 </td>
   <td style="text-align:right;"> 54.4970 </td>
   <td style="text-align:right;"> 0.1305 </td>
   <td style="text-align:right;"> 0.1069 </td>
   <td style="text-align:right;"> 0.2281 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0010 </td>
   <td style="text-align:right;"> 40.8017 </td>
   <td style="text-align:right;"> 48.9620 </td>
   <td style="text-align:right;"> 0.0890 </td>
   <td style="text-align:right;"> 0.0759 </td>
   <td style="text-align:right;"> 0.1825 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0008 </td>
   <td style="text-align:right;"> 40.4386 </td>
   <td style="text-align:right;"> 45.1712 </td>
   <td style="text-align:right;"> 0.1148 </td>
   <td style="text-align:right;"> 0.0318 </td>
   <td style="text-align:right;"> 0.3608 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0004 </td>
   <td style="text-align:right;"> 41.5602 </td>
   <td style="text-align:right;"> 41.2550 </td>
   <td style="text-align:right;"> 0.0946 </td>
   <td style="text-align:right;"> 0.0329 </td>
   <td style="text-align:right;"> 0.2719 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0010 </td>
   <td style="text-align:right;"> 40.0996 </td>
   <td style="text-align:right;"> 44.9429 </td>
   <td style="text-align:right;"> 0.0832 </td>
   <td style="text-align:right;"> 0.0477 </td>
   <td style="text-align:right;"> 0.2207 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-55_1be4df4c6b6003c5f9215d851037d32a">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ydat <span class="ot">&lt;-</span> dataMultinomial <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Ocupado, Desocupado, Inactivo) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(ydat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> Ocupado </th>
   <th style="text-align:right;"> Desocupado </th>
   <th style="text-align:right;"> Inactivo </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 2222 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 414 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2370 </td>
   <td style="text-align:right;"> 75 </td>
   <td style="text-align:right;"> 734 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1699 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 237 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2406 </td>
   <td style="text-align:right;"> 131 </td>
   <td style="text-align:right;"> 906 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1769 </td>
   <td style="text-align:right;"> 28 </td>
   <td style="text-align:right;"> 451 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2370 </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 503 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1480 </td>
   <td style="text-align:right;"> 137 </td>
   <td style="text-align:right;"> 791 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2150 </td>
   <td style="text-align:right;"> 63 </td>
   <td style="text-align:right;"> 459 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1838 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 188 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2038 </td>
   <td style="text-align:right;"> 42 </td>
   <td style="text-align:right;"> 514 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2271 </td>
   <td style="text-align:right;"> 51 </td>
   <td style="text-align:right;"> 1021 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2435 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 702 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2417 </td>
   <td style="text-align:right;"> 122 </td>
   <td style="text-align:right;"> 1018 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2385 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 1062 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 6928 </td>
   <td style="text-align:right;"> 549 </td>
   <td style="text-align:right;"> 3498 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2448 </td>
   <td style="text-align:right;"> 43 </td>
   <td style="text-align:right;"> 879 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 998 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 221 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1432 </td>
   <td style="text-align:right;"> 71 </td>
   <td style="text-align:right;"> 510 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1462 </td>
   <td style="text-align:right;"> 57 </td>
   <td style="text-align:right;"> 351 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2887 </td>
   <td style="text-align:right;"> 48 </td>
   <td style="text-align:right;"> 956 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1927 </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 294 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 2384 </td>
   <td style="text-align:right;"> 34 </td>
   <td style="text-align:right;"> 571 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1966 </td>
   <td style="text-align:right;"> 107 </td>
   <td style="text-align:right;"> 781 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1376 </td>
   <td style="text-align:right;"> 56 </td>
   <td style="text-align:right;"> 477 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1945 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 548 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-56_743f1c9fcd4d5612ede0898f5e8baf47">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">D =</span> <span class="fu">nrow</span>(dataMultinomial),</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">P =</span> <span class="fu">ncol</span>(ydat),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> ydat</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-57_822fa4934f7b8479e270028ad7af4b67">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tiempo 5 minutos </span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>model_Multinomial <span class="ot">&lt;-</span> fitMultinomial<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sample_data, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 29.2 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 29.6 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 30.4 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 31.7 seconds.

All 4 chains finished successfully.
Mean chain execution time: 30.2 seconds.
Total execution time: 31.9 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-58_62fac35f5a2c440eaf4aa313ae42ec1d">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>model_Multinomial<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1,1] </td>
   <td style="text-align:right;"> -4.6670 </td>
   <td style="text-align:right;"> -4.6712 </td>
   <td style="text-align:right;"> 0.4168 </td>
   <td style="text-align:right;"> 0.4001 </td>
   <td style="text-align:right;"> -5.3435 </td>
   <td style="text-align:right;"> -3.9573 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,1] </td>
   <td style="text-align:right;"> -0.2170 </td>
   <td style="text-align:right;"> -0.2143 </td>
   <td style="text-align:right;"> 0.1498 </td>
   <td style="text-align:right;"> 0.1502 </td>
   <td style="text-align:right;"> -0.4653 </td>
   <td style="text-align:right;"> 0.0216 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,2] </td>
   <td style="text-align:right;"> 92.3219 </td>
   <td style="text-align:right;"> 92.5497 </td>
   <td style="text-align:right;"> 27.2181 </td>
   <td style="text-align:right;"> 27.0300 </td>
   <td style="text-align:right;"> 47.8122 </td>
   <td style="text-align:right;"> 136.0794 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,2] </td>
   <td style="text-align:right;"> 52.7939 </td>
   <td style="text-align:right;"> 52.7172 </td>
   <td style="text-align:right;"> 10.0217 </td>
   <td style="text-align:right;"> 10.1521 </td>
   <td style="text-align:right;"> 36.2566 </td>
   <td style="text-align:right;"> 69.1872 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,3] </td>
   <td style="text-align:right;"> 0.0025 </td>
   <td style="text-align:right;"> 0.0025 </td>
   <td style="text-align:right;"> 0.0037 </td>
   <td style="text-align:right;"> 0.0039 </td>
   <td style="text-align:right;"> -0.0036 </td>
   <td style="text-align:right;"> 0.0085 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,3] </td>
   <td style="text-align:right;"> 0.0072 </td>
   <td style="text-align:right;"> 0.0072 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 0.0052 </td>
   <td style="text-align:right;"> 0.0091 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,4] </td>
   <td style="text-align:right;"> -0.0277 </td>
   <td style="text-align:right;"> -0.0278 </td>
   <td style="text-align:right;"> 0.0104 </td>
   <td style="text-align:right;"> 0.0106 </td>
   <td style="text-align:right;"> -0.0444 </td>
   <td style="text-align:right;"> -0.0108 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,4] </td>
   <td style="text-align:right;"> -0.0186 </td>
   <td style="text-align:right;"> -0.0186 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> -0.0248 </td>
   <td style="text-align:right;"> -0.0123 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,5] </td>
   <td style="text-align:right;"> 8.2124 </td>
   <td style="text-align:right;"> 8.0984 </td>
   <td style="text-align:right;"> 3.4952 </td>
   <td style="text-align:right;"> 3.4888 </td>
   <td style="text-align:right;"> 2.5704 </td>
   <td style="text-align:right;"> 14.0180 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,5] </td>
   <td style="text-align:right;"> -10.3396 </td>
   <td style="text-align:right;"> -10.3613 </td>
   <td style="text-align:right;"> 1.2244 </td>
   <td style="text-align:right;"> 1.2192 </td>
   <td style="text-align:right;"> -12.3238 </td>
   <td style="text-align:right;"> -8.2934 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,6] </td>
   <td style="text-align:right;"> -1.2523 </td>
   <td style="text-align:right;"> -1.2586 </td>
   <td style="text-align:right;"> 1.3068 </td>
   <td style="text-align:right;"> 1.2816 </td>
   <td style="text-align:right;"> -3.4254 </td>
   <td style="text-align:right;"> 0.9144 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,6] </td>
   <td style="text-align:right;"> -4.0274 </td>
   <td style="text-align:right;"> -4.0272 </td>
   <td style="text-align:right;"> 0.4384 </td>
   <td style="text-align:right;"> 0.4438 </td>
   <td style="text-align:right;"> -4.7420 </td>
   <td style="text-align:right;"> -3.3217 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,7] </td>
   <td style="text-align:right;"> 5.2070 </td>
   <td style="text-align:right;"> 5.2043 </td>
   <td style="text-align:right;"> 0.9138 </td>
   <td style="text-align:right;"> 0.9149 </td>
   <td style="text-align:right;"> 3.6789 </td>
   <td style="text-align:right;"> 6.7294 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,7] </td>
   <td style="text-align:right;"> 2.9524 </td>
   <td style="text-align:right;"> 2.9542 </td>
   <td style="text-align:right;"> 0.3139 </td>
   <td style="text-align:right;"> 0.3183 </td>
   <td style="text-align:right;"> 2.4342 </td>
   <td style="text-align:right;"> 3.4517 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-59_647078e416110cdf13df2424d89dc31b">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-60_478533e99498d392bef04a099be845f2">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-60-1.png" style="height:200.0%" width="672"></p>
</div>
</div>
<p>La predicción del número de persona en cada estado se obtiene como:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-61_d4afd840bc8bfeb9bfcfe7e6e64e4a01">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>ydat2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ydat)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> ydat2, </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                 y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para la probabilidad de pertenecer al estado <span class="math inline">\(k-esimo\)</span> se obtiene como:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-62_c52e014bf642a642d58e5570885381de">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ydat2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ydat<span class="sc">/</span><span class="fu">rowSums</span>(ydat))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"theta"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> ydat2, </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                 y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos_fig/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>